(function(exports){"use strict";var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};function __extends(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}var __assign=function(){__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0)t[p]=s[p];if(s!=null&&typeof Object.getOwnPropertySymbols==="function")for(var i=0,p=Object.getOwnPropertySymbols(s);i<p.length;i++){if(e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i]))t[p[i]]=s[p[i]]}return t}function __values(o){var s=typeof Symbol==="function"&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&typeof o.length==="number")return{next:function(){if(o&&i>=o.length)o=void 0;return{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(o,n){var m=typeof Symbol==="function"&&o[Symbol.iterator];if(!m)return o;var i=m.call(o),r,ar=[],e;try{while((n===void 0||n-- >0)&&!(r=i.next()).done)ar.push(r.value)}catch(error){e={error:error}}finally{try{if(r&&!r.done&&(m=i["return"]))m.call(i)}finally{if(e)throw e.error}}return ar}function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar}var _global=function(){return this||(0,eval)("this")}();_global.multiApps={};_global.currentAppId="";_global.globComponentRegistPath="";_global.sharedData={};_global.globDynamicComponentEntry="";var loadScript=_global.loadScript;function isObject(val){return Object.prototype.toString.call(val).slice(8,-1)==="Object"}function hasProperty(object,property){return Object.prototype.hasOwnProperty.call(object||{},property)}function getDataType(data){return Object.prototype.toString.call(data).split(" ")[1].slice(0,-1)}var ThirdScriptError=function(_super){__extends(ThirdScriptError,_super);function ThirdScriptError(msg){var _this=_super.call(this,""+msg)||this;_this.type="ThirdScriptError";return _this}return ThirdScriptError}(Error);var AppServiceSdkKnownError=function(_super){__extends(AppServiceSdkKnownError,_super);function AppServiceSdkKnownError(msg){var _this=_super.call(this,"APP-SERVICE-SDK: + "+msg)||this;_this.type="AppServiceSdkKnownError";return _this}return AppServiceSdkKnownError}(Error);function throttle(fn,delay,cardSetTimeout){var _this=this;var waiting=false;return function(){var args=[];for(var _i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}if(!waiting){fn.apply(_this,args);waiting=true;cardSetTimeout((function(){waiting=false}),delay)}}}function debounce(fn,time,cardSetTimeout){var timer=null;time=time||500;return function(){var context=this;var args=__spread(arguments);clearTimeout(timer);timer=cardSetTimeout((function(){fn.apply(context,args)}),time)}}var alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var btoa=btoa||function(e){for(var t,n,r=String(e),o="",i=0,a=alphabet;r.charAt(0|i)||(a="=",i%1);o+=a.charAt(63&t>>8-i%1*8)){if((n=r.charCodeAt(i+=.75))>255){throw new Error('"btoa" failed')}t=t<<8|n}return o};var atob=atob||function(e){var t=String(e).replace(/=+$/,""),n="";if(t.length%4==1){throw new Error('"atob" failed')}for(var r,o,i=0,a=0;o=t.charAt(a++),o;~o&&(r=i%4?64*r+o:o,i++%4)?n+=String.fromCharCode(255&r>>(-2*i&6)):0){o=alphabet.indexOf(o)}return n};function encodeToUi8Base64(ab){var string="";var ui8aReader=new Uint8Array(ab),len=ui8aReader.byteLength;for(var i=0;i<len;i++){string+=String.fromCharCode(ui8aReader[i])}return btoa(string)}function decodeFromUi8Base64(string){var base64String=atob(string),len=base64String.length,ui8aReader=new Uint8Array(len);for(var i=0;i<len;i++){ui8aReader[i]=base64String.charCodeAt(i)}return ui8aReader.buffer}function _new(data){return{base64:encodeToUi8Base64(data)}}function _get(data){if(data!=null){if(data.base64){return decodeFromUi8Base64(data.base64)}else{return undefined}}}function isType(type){return function(arg){return Object.prototype.toString.call(arg).toLowerCase()===("[object "+type+"]").toLowerCase()}}function _pack(data){if(isType("Object")(data)===false){return data}var needTransAttrs=[];for(var key in data){var item=data[key];if(item!==undefined&&item instanceof ArrayBuffer&&item.byteLength!==undefined){var obj=_new(item);obj["key"]=key;needTransAttrs.push(obj)}}if(needTransAttrs.length>0){for(var i=0;i<needTransAttrs.length;i++){var tmp=needTransAttrs[i];delete data[tmp.key]}data.__nativeBuffers__=needTransAttrs}return data}function _pack2(data){if(isType("Object")(data)===false){return data}var needTransAttrs=[];for(var key in data){var item=data[key];if(item!==undefined&&item instanceof ArrayBuffer&&item.byteLength!==undefined){var obj={value:item};obj["key"]=key;needTransAttrs.push(obj)}}if(needTransAttrs.length>0){for(var i=0;i<needTransAttrs.length;i++){var tmp=needTransAttrs[i];delete data[tmp.key]}data.__nativeBuffers__=needTransAttrs}return data}function _unpack(data){if(isType("Object")(data)===false||null==data.__nativeBuffers__){return data}var nbs=data.__nativeBuffers__;delete data.__nativeBuffers__;for(var i=0;i<nbs.length;i++){var item=nbs[i];if(null!=item){var tmp=_get(item);if(tmp!==undefined&&tmp instanceof ArrayBuffer){data[item.key]=tmp}}}return data}function _unpack2(data){if(isType("Object")(data)===false||null==data.__nativeBuffers__){return data}var nbs=data.__nativeBuffers__;delete data.__nativeBuffers__;for(var i=0;i<nbs.length;i++){var item=nbs[i];if(item){var tmp=item.value?item.value:_get(item);if(tmp!==undefined&&tmp instanceof ArrayBuffer){data[item.key]=tmp}}}return data}var NativeBuffer={new:_new,get:_get,pack:_pack,pack2:_pack2,unpack:_unpack,unpack2:_unpack2};var lifeCycles=["onLoad","onShow","onHide","onReady","onDestroy","onError"];var lifeCycleFun=lifeCycles.reduce((function(preVal,currVal){preVal[currVal]=function(){};return preVal}),{});var ErrorCode;(function(ErrorCode){ErrorCode[ErrorCode["SUCCESS"]=0]="SUCCESS";ErrorCode[ErrorCode["UNKNOWN"]=1]="UNKNOWN";ErrorCode[ErrorCode["NODE_NOT_FOUND"]=2]="NODE_NOT_FOUND";ErrorCode[ErrorCode["METHOD_NOT_FOUND"]=3]="METHOD_NOT_FOUND";ErrorCode[ErrorCode["PARAM_INVALID"]=4]="PARAM_INVALID";ErrorCode[ErrorCode["SELECTOR_NOT_SUPPORTED"]=5]="SELECTOR_NOT_SUPPORTED"})(ErrorCode||(ErrorCode={}));var BDLYNX_CORE={filename:"bdlynx_core",slot:"25bb3da5c93d3b32c03efe6c4e73bdca6f9bff0f"};function reportError(error,nativeApp){var _a;var report=(_a=_global===null||_global===void 0?void 0:_global.LynxSDKCore)===null||_a===void 0?void 0:_a.report;try{if(typeof report==="function"){report(error,nativeApp,BDLYNX_CORE)}else{nativeConsole.error("report is not a function",error.message)}}catch(err){nativeConsole.error("API reportError err:",err)}}function wrapUserFunction(desc,instance,callback){var _a;var reportUser=(_a=_global===null||_global===void 0?void 0:_global.LynxSDKCore)===null||_a===void 0?void 0:_a.reportUser;try{if(typeof reportUser==="function"){return reportUser(desc,instance,callback,BDLYNX_CORE)}else{nativeConsole.error("reportUser is not a function",desc);return fnApply(callback,desc)}}catch(err){nativeConsole.error("API reportUser err:",err)}}function surroundByTryCatchFactory(func,appInstance,msg){var _a;if(msg===void 0){msg=""}var reportInner=(_a=_global===null||_global===void 0?void 0:_global.LynxSDKCore)===null||_a===void 0?void 0:_a.reportInner;try{if(typeof reportInner==="function"){return reportInner(msg,appInstance,func,BDLYNX_CORE)}else{nativeConsole.error("reportInner is not a function",func,msg);return fnApply(func,msg)}}catch(err){nativeConsole.error("API reportInner err:",err)}}function surroundByUserTryCatch(func,appInstance,msg){var _a;if(msg===void 0){msg=""}if(!func)return noop;var reportUser=(_a=_global===null||_global===void 0?void 0:_global.LynxSDKCore)===null||_a===void 0?void 0:_a.reportUser;try{if(typeof reportUser==="function"){return reportUser(msg,appInstance,func,BDLYNX_CORE)}else{nativeConsole.error("reportUser is not a function",func,msg);return fnApply(func,msg)}}catch(err){nativeConsole.error("API reportUser err:",err)}}function fnApply(func,msg){return function(){var res;try{res=func.apply(func,arguments)}catch(err){nativeConsole.error(msg||""+err.message)}return res}}var BaseError=function(_super){__extends(BaseError,_super);function BaseError(message,stack){var _this=_super.call(this,message)||this;_this.message=message;_this.stack=stack;return _this}return BaseError}(Error);var InternalError=function(_super){__extends(InternalError,_super);function InternalError(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.kind="INTERNAL_ERROR";return _this}return InternalError}(BaseError);var UserError=function(_super){__extends(UserError,_super);function UserError(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.kind="USER_ERROR";return _this}return UserError}(BaseError);var UserValidateError=function(_super){__extends(UserValidateError,_super);function UserValidateError(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="USER_VALIDATE_ERROR";return _this}return UserValidateError}(UserError);var UserRuntimeError=function(_super){__extends(UserRuntimeError,_super);function UserRuntimeError(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="USER_RUNTIME_ERROR";return _this}return UserRuntimeError}(UserError);var InternalRuntimeError=function(_super){__extends(InternalRuntimeError,_super);function InternalRuntimeError(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="INTERNAL_RUNTIME_ERROR";return _this}return InternalRuntimeError}(InternalError);var InvokeError=function(_super){__extends(InvokeError,_super);function InvokeError(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.name="INVOKE_ERROR";return _this}return InvokeError}(InternalError);var AppServiceEngineKnownError=function(_super){__extends(AppServiceEngineKnownError,_super);function AppServiceEngineKnownError(msg){var _this=_super.call(this,"APP-SERVICE-Engine: "+msg)||this;_this.type="AppServiceEngineKnownError";return _this}return AppServiceEngineKnownError}(Error);function parseApiRes(apiName,apiRes,appInstance){if(typeof apiRes==="string"){try{apiRes=JSON.parse(apiRes)}catch(e){reportError(new InternalRuntimeError("parseApiRes "+apiName+" JSON.parse error: "+e.message,e.stack),appInstance._nativeApp)}}var errMsg=apiRes.errMsg||apiName+":ok";var status=getStatus(apiName,errMsg);return{errMsg:errMsg,status:status}}function afterApiCall(apiName,apiRes,params,appInstance){if(typeof apiRes==="string"){try{apiRes=JSON.parse(apiRes)}catch(e){reportError(new InternalRuntimeError("afterApiCall "+apiName+" JSON.parse error: "+e.message,e.stack),appInstance._nativeApp)}}var errMsg=apiRes.errMsg||apiName+":ok";var status=getStatus(apiName,errMsg);var _a=params||{},success=_a.success,fail=_a.fail,complete=_a.complete;switch(status){case"success":success&&surroundByUserTryCatch(success,appInstance,"afterApiCall "+apiName).call(appInstance,apiRes);break;case"fail":fail&&surroundByUserTryCatch(fail,appInstance,"afterApiCall "+apiName).call(appInstance,apiRes)}complete&&surroundByUserTryCatch(complete,appInstance,"afterApiCall "+apiName).call(appInstance,apiRes)}function nativeInvoke(appInstance,api,param,cb,libHooks){if(libHooks===void 0){libHooks={}}var BDLynxModule=appInstance._nativeApp.nativeModuleProxy.BDLynxModule;param=NativeBuffer.pack(param);for(var c in libHooks){libHooks[c]=surroundByTryCatchFactory(libHooks[c],appInstance)}var beforeAll=libHooks.beforeAll,beforeSuccess=libHooks.beforeSuccess,afterSuccess=libHooks.afterSuccess,beforeCancel=libHooks.beforeCancel,afterCancel=libHooks.afterCancel,beforeFail=libHooks.beforeFail,afterFail=libHooks.afterFail,afterAll=libHooks.afterAll;var wrapperCb=function(res){if(typeof res==="string"){try{res=JSON.parse(res)}catch(e){reportError(new InternalRuntimeError("afterApiCall "+api+" JSON.parse error: "+e.message,e.stack),appInstance._nativeApp)}}var errMsg=res.errMsg||api+":ok";var status=getStatus(api,errMsg);beforeAll===null||beforeAll===void 0?void 0:beforeAll(res);switch(status){case"success":beforeSuccess===null||beforeSuccess===void 0?void 0:beforeSuccess(res);cb(res);afterSuccess===null||afterSuccess===void 0?void 0:afterSuccess(res);break;case"cancel":res.errMsg=res.errMsg.replace(api+":cancel",api+":fail cancel");beforeCancel===null||beforeCancel===void 0?void 0:beforeCancel(res);cb(res);afterCancel===null||afterCancel===void 0?void 0:afterCancel(res);break;case"fail":beforeFail===null||beforeFail===void 0?void 0:beforeFail(res);cb(res);afterFail===null||afterFail===void 0?void 0:afterFail(res)}afterAll===null||afterAll===void 0?void 0:afterAll(res)};var res=BDLynxModule.invoke(api,param,wrapperCb);if(res!==undefined&&res!==null&&res!==""){wrapperCb(res)}}function validateUrl(url,protocol){if(protocol===void 0){protocol="http"}if(protocol==="http"){return/^(http|https):\/\/.*/i.test(url)}else if(protocol==="websocket"){return/^(ws|wss):\/\/.*/i.test(url)}}function urlEncodeFormData(data,needEncode){if(needEncode===void 0){needEncode=false}var res=[];if(data===undefined||typeof data!=="object"){return data}for(var key in data){if(hasProperty(data,key)){if(needEncode){try{res.push(encodeURIComponent(key)+"="+encodeURIComponent(data[key]))}catch(err){res.push(key+"="+data[key])}}else{res.push(key+"="+data[key])}}}return res.join("&")}function addQueryStringToUrl(url,data){if(typeof url==="string"&&typeof data==="object"&&data!==null&&Object.keys(data).length>0){var _a=getDataFromUrl(url),_b=_a.urlQueryObj,urlQueryObj=_b===void 0?{}:_b,_c=_a.prefix,prefix=_c===void 0?"":_c;var dataObj=Object.keys(data).reduce((function(dataobj,key){if(typeof data[key]==="object"){dataobj[encodeURIComponent(key)]=encodeURIComponent(JSON.stringify(data[key]))}else{dataobj[encodeURIComponent(key)]=encodeURIComponent(data[key])}return dataobj}),{});return prefix+"?"+urlEncodeFormData(Object.assign(urlQueryObj,dataObj))}return url}function getDataFromUrl(url){if(typeof url==="string"){var ab=url.split("?");var search=ab[1]||"";var urlQueryObj=search.split("&").reduce((function(searchobj,pair){if(typeof pair==="string"&&pair.length>0){var ps=pair.split("=");searchobj[ps[0]]=ps[1]}return searchobj}),{});return{urlQueryObj:urlQueryObj,prefix:ab[0]}}return{}}function convertObjectValueToString(obj){return Object.keys(obj).reduce((function(ret,key){if(typeof obj[key]==="string"){ret[key]=obj[key]}else if(typeof obj[key]==="number"){ret[key]=""+obj[key]}else{ret[key]=Object.prototype.toString.apply(obj[key])}return ret}),{})}var isArray=Array.isArray||function(e){return getDataType(e)==="Array"};function isEmptyArray(e){return isArray(e)&&e.length===0}function noop(){}function beforeInvokeFail(api,params,msg,appInstance){var res={errMsg:api+":fail "+msg};surroundByUserTryCatch(params.fail||noop,appInstance,msg).call(appInstance,res);surroundByUserTryCatch(params.complete||noop,appInstance,msg).call(appInstance,res)}function getStatus(method,errMsg){if(errMsg.startsWith(method+":ok")){return"success"}if(errMsg.startsWith(method+":fail")){return"fail"}if(errMsg.startsWith(method+":cancel")){return"cancel"}throw new InvokeError(method+" response's errMsg("+errMsg+") incorrect")}function checkObjectKeys(obj){var keysArr=[];for(var key in obj){keysArr.push(key)}return keysArr.length}function _anyTypeToString(any){var protoType=getDataType(any);if(protoType==="Array"||protoType==="Object"){any=JSON.stringify(any)}else if(protoType==="String"||protoType==="Number"||protoType==="Boolean"){any=any.toString()}else if(protoType==="Date"){any=any.getTime().toString()}else if(protoType==="Undefined"){any="undefined"}else if(protoType==="Null"){any="null"}else{any=""}return{data:any,dataType:protoType}}function _stringToAnyType(str,protoType){switch(protoType){case"String":return str;case"Array":case"Object":return JSON.parse(str);case"Number":return parseFloat(str);case"Boolean":return str==="true";case"Date":return new Date(parseInt(str,10));case"Undefined":return undefined;case"Null":return null;default:return""}}function isAndroid(){var _a;return((_a=SystemInfo===null||SystemInfo===void 0?void 0:SystemInfo.platform)===null||_a===void 0?void 0:_a.toLowerCase())==="android"}function compareVersion(a,b,op){var result=0;if(a!==b){var av=a.split(".");var bv=b.split(".");var len=Math.max(av.length,bv.length);for(var i=0;i<len;i++){var x=parseInt(av[i],10)||0;var y=parseInt(bv[i],10)||0;if(x>y){result=1;break}else if(x<y){result=-1;break}}}if(!op){return result}switch(op){case">":return result>0;case"<":return result<0;case"=":return result===0;case">=":return result>=0;case"<=":return result<=0}}function deserialize(schema,need_checksum){if(schema===void 0){schema=""}if(need_checksum===void 0){need_checksum=true}if(need_checksum&&!checksum(schema)){throw new Error("illegal schema\nchecksum failed, please check your schema")}var valid_keys=["version","app_id","scene","launch_mode","version_type","token","query","bdp_log","meta","inspect","referer_info","bdpsum"];var need_deserialization_keys=["query","bdp_log","meta","inspect","referer_info"];var result={__any__:{},query:{},protocol:"",host:"",path:""};var _1=schema.split("://");if(_1.length!==2){throw new Error("illegal protocol, please check your schema")}result.protocol=_1[0];schema=_1[1];var _2=schema.split("?");if(_2.length!==2){throw new Error("illegal host, please check your schema")}result.host=_2[0];schema=_2[1];schema.split("&").forEach((function(search){var _a;var _3=search.split("=");if(_3.length!==2){console.warn("illegal key&value:",_3);return}var key=_3[0];var val=_3[1];if(valid_keys.indexOf(key)>-1){result[key]=decodeURIComponent(val);if(need_deserialization_keys.indexOf(key)>-1){try{result[key]=JSON.parse(result[key])}catch(ex){}}}else if(key==="start_page"){var start_page=decodeURIComponent(val);var path=start_page;var query_string="";var query_object_1={};if(start_page.indexOf("?")>-1){_a=__read(start_page.split("?"),2),path=_a[0],query_string=_a[1]}query_string.split("&").forEach((function(search){var _4=search.split("=");if(_4.length!==2){return}query_object_1[_4[0]]=decodeURIComponent(_4[1]);if(query_object_1[_4[0]].charAt(0)==="{"||query_object_1[_4[0]].charAt(0)==="["){try{query_object_1[_4[0]]=JSON.parse(decodeURIComponent(_4[1]))}catch(ex){}}}));result.path=path;result.query=query_object_1}else if(key){console.warn("unrecognized key&value: "+key+": "+val);try{result.__any__[key]=JSON.parse(decodeURIComponent(val))}catch(ex){result.__any__[key]=decodeURIComponent(val)}}}));if(is_empty_simple(result.query)){delete result.query}if(is_empty_simple(result.__any__)){delete result.__any__}delete result["bdpsum"];return result}function checksum(schema){if(schema===void 0){schema=""}var _1=schema.split("&bdpsum=");if(_1.length<=1){return false}var schema_string=_1[0];var input_sum=_1[1];return getsum(schema_string)===input_sum}function is_empty_simple(object){if(typeof object==="object"&&!Array.isArray(object)){for(var k in object){return false}}return true}var md5=function(){function t(n,t){var r=(65535&n)+(65535&t);return(n>>16)+(t>>16)+(r>>16)<<16|65535&r}function r(n,t){return n<<t|n>>>32-t}function e(n,e,o,u,c,f){return t(r(t(t(e,n),t(u,f)),c),o)}function o(n,t,r,o,u,c,f){return e(t&r|~t&o,n,t,u,c,f)}function u(n,t,r,o,u,c,f){return e(t&o|r&~o,n,t,u,c,f)}function c(n,t,r,o,u,c,f){return e(t^r^o,n,t,u,c,f)}function f(n,t,r,o,u,c,f){return e(r^(t|~o),n,t,u,c,f)}function i(n,r){n[r>>5]|=128<<r%32,n[14+(r+64>>>9<<4)]=r;var e,i,a,d,h,l=1732584193,g=-271733879,v=-1732584194,m=271733878;for(e=0;e<n.length;e+=16)i=l,a=g,d=v,h=m,g=f(g=f(g=f(g=f(g=c(g=c(g=c(g=c(g=u(g=u(g=u(g=u(g=o(g=o(g=o(g=o(g,v=o(v,m=o(m,l=o(l,g,v,m,n[e],7,-680876936),g,v,n[e+1],12,-389564586),l,g,n[e+2],17,606105819),m,l,n[e+3],22,-1044525330),v=o(v,m=o(m,l=o(l,g,v,m,n[e+4],7,-176418897),g,v,n[e+5],12,1200080426),l,g,n[e+6],17,-1473231341),m,l,n[e+7],22,-45705983),v=o(v,m=o(m,l=o(l,g,v,m,n[e+8],7,1770035416),g,v,n[e+9],12,-1958414417),l,g,n[e+10],17,-42063),m,l,n[e+11],22,-1990404162),v=o(v,m=o(m,l=o(l,g,v,m,n[e+12],7,1804603682),g,v,n[e+13],12,-40341101),l,g,n[e+14],17,-1502002290),m,l,n[e+15],22,1236535329),v=u(v,m=u(m,l=u(l,g,v,m,n[e+1],5,-165796510),g,v,n[e+6],9,-1069501632),l,g,n[e+11],14,643717713),m,l,n[e],20,-373897302),v=u(v,m=u(m,l=u(l,g,v,m,n[e+5],5,-701558691),g,v,n[e+10],9,38016083),l,g,n[e+15],14,-660478335),m,l,n[e+4],20,-405537848),v=u(v,m=u(m,l=u(l,g,v,m,n[e+9],5,568446438),g,v,n[e+14],9,-1019803690),l,g,n[e+3],14,-187363961),m,l,n[e+8],20,1163531501),v=u(v,m=u(m,l=u(l,g,v,m,n[e+13],5,-1444681467),g,v,n[e+2],9,-51403784),l,g,n[e+7],14,1735328473),m,l,n[e+12],20,-1926607734),v=c(v,m=c(m,l=c(l,g,v,m,n[e+5],4,-378558),g,v,n[e+8],11,-2022574463),l,g,n[e+11],16,1839030562),m,l,n[e+14],23,-35309556),v=c(v,m=c(m,l=c(l,g,v,m,n[e+1],4,-1530992060),g,v,n[e+4],11,1272893353),l,g,n[e+7],16,-155497632),m,l,n[e+10],23,-1094730640),v=c(v,m=c(m,l=c(l,g,v,m,n[e+13],4,681279174),g,v,n[e],11,-358537222),l,g,n[e+3],16,-722521979),m,l,n[e+6],23,76029189),v=c(v,m=c(m,l=c(l,g,v,m,n[e+9],4,-640364487),g,v,n[e+12],11,-421815835),l,g,n[e+15],16,530742520),m,l,n[e+2],23,-995338651),v=f(v,m=f(m,l=f(l,g,v,m,n[e],6,-198630844),g,v,n[e+7],10,1126891415),l,g,n[e+14],15,-1416354905),m,l,n[e+5],21,-57434055),v=f(v,m=f(m,l=f(l,g,v,m,n[e+12],6,1700485571),g,v,n[e+3],10,-1894986606),l,g,n[e+10],15,-1051523),m,l,n[e+1],21,-2054922799),v=f(v,m=f(m,l=f(l,g,v,m,n[e+8],6,1873313359),g,v,n[e+15],10,-30611744),l,g,n[e+6],15,-1560198380),m,l,n[e+13],21,1309151649),v=f(v,m=f(m,l=f(l,g,v,m,n[e+4],6,-145523070),g,v,n[e+11],10,-1120210379),l,g,n[e+2],15,718787259),m,l,n[e+9],21,-343485551),l=t(l,i),g=t(g,a),v=t(v,d),m=t(m,h);return[l,g,v,m]}function a(n){var t,r="",e=32*n.length;for(t=0;t<e;t+=8)r+=String.fromCharCode(n[t>>5]>>>t%32&255);return r}function d(n){var t,r=[];for(r[(n.length>>2)-1]=void 0,t=0;t<r.length;t+=1)r[t]=0;var e=8*n.length;for(t=0;t<e;t+=8)r[t>>5]|=(255&n.charCodeAt(t/8))<<t%32;return r}function h(n){return a(i(d(n),8*n.length))}function l(n,t){var r,e,o=d(n),u=[],c=[];for(u[15]=c[15]=void 0,o.length>16&&(o=i(o,8*n.length)),r=0;r<16;r+=1)u[r]=909522486^o[r],c[r]=1549556828^o[r];return e=i(u.concat(d(t)),512+8*t.length),a(i(c.concat(e),640))}function g(n){var t,r,e="";for(r=0;r<n.length;r+=1)t=n.charCodeAt(r),e+="0123456789abcdef".charAt(t>>>4&15)+"0123456789abcdef".charAt(15&t);return e}function v(n){return unescape(encodeURIComponent(n))}function m(n){return h(v(n))}function p(n){return g(m(n))}function s(n,t){return l(v(n),v(t))}function C(n,t){return g(s(n,t))}function A(n,t,r){return t?r?s(t,n):C(t,n):r?m(n):p(n)}return A}();function getsum(schema_string){var cuttingidx=schema_string.indexOf("://");var cuttinglastindex=schema_string.lastIndexOf("://");if(cuttingidx!==cuttinglastindex){throw new Error("illeagal schema\ntoo much '://', please check your schema")}schema_string=schema_string.substring(cuttingidx+3);var md_5=md5(schema_string.substring(0,10)+"bytetimordance"+schema_string.substring(10));var sum=md_5.substring(2,6)+md_5.substring(20,23);return sum}function encodeUrlQuery(url){if(typeof url==="string"){return encodeEachValue(url)}return url}function encodeEachValue(url){var _a=__read(url.split("?"),2),prefix=_a[0],search=_a[1];if(search){var newSearch=search.split("&").map((function(kv){var _a=__read(kv.split("="),2),k=_a[0],_b=_a[1],v=_b===void 0?"":_b;if(!k)return"";return encodeURIComponent(k)+"="+encodeURIComponent(v)})).filter(truthy).join("&");return prefix+"?"+newSearch}return prefix}function truthy(value){return Boolean(value)}var EventEmitter=function(){function EventEmitter(){this._events=new Map;this._all=[]}EventEmitter.prototype.addListener=function(eventName,listener,context){var event=this._events.get(eventName);if(event){event.push({listener:listener,context:context})}else{this._events.set(eventName,[{listener:listener,context:context}])}};EventEmitter.prototype.removeListener=function(eventName,listener){var e_1,_a;if(typeof listener!=="function"){throw new Error("removeListener only takes instances of Function")}var events=this._events.get(eventName);var flag=false;var index=0;if(Array.isArray(events)){try{for(var events_1=__values(events),events_1_1=events_1.next();!events_1_1.done;events_1_1=events_1.next()){var item=events_1_1.value;if(listener===item.listener){flag=true;break}index++}}catch(e_1_1){e_1={error:e_1_1}}finally{try{if(events_1_1&&!events_1_1.done&&(_a=events_1.return))_a.call(events_1)}finally{if(e_1)throw e_1.error}}flag&&events.splice(index,1)}};EventEmitter.prototype.emit=function(eventName,data){var e_2,_a;var events=this._events.get(eventName);if(Array.isArray(events)){try{for(var events_2=__values(events),events_2_1=events_2.next();!events_2_1.done;events_2_1=events_2.next()){var item=events_2_1.value;var listener=item.listener,context=item.context;if(typeof listener==="function"){listener.apply(context||this,Array.isArray(data)?data:[data])}}}catch(e_2_1){e_2={error:e_2_1}}finally{try{if(events_2_1&&!events_2_1.done&&(_a=events_2.return))_a.call(events_2)}finally{if(e_2)throw e_2.error}}}else{nativeConsole.warn("emit event "+eventName+" is not register.")}this._all.forEach((function(func){func.call(this,eventName,data)}))};EventEmitter.prototype.removeAllListerners=function(eventName){this._events.delete(eventName)};EventEmitter.prototype.removeAllListeners=function(eventName){this._events.delete(eventName)};EventEmitter.prototype.trigger=function(eventName,params){var e_3,_a;var events=this._events.get(eventName);if(Array.isArray(events)){if(typeof params==="string"){params=JSON.parse(params)}try{for(var events_3=__values(events),events_3_1=events_3.next();!events_3_1.done;events_3_1=events_3.next()){var item=events_3_1.value;var listener=item.listener,context=item.context;if(typeof listener==="function"){listener.call(context||this,params)}}}catch(e_3_1){e_3={error:e_3_1}}finally{try{if(events_3_1&&!events_3_1.done&&(_a=events_3.return))_a.call(events_3)}finally{if(e_3)throw e_3.error}}}else{nativeConsole.warn("trigger event "+eventName+" is not register.")}};EventEmitter.prototype.toggle=function(eventName){var data=[];for(var _i=1;_i<arguments.length;_i++){data[_i-1]=arguments[_i]}this.emit(eventName,data)};EventEmitter.prototype.onAny=function(fn){if(typeof fn!=="function"){throw new Error("onAny only accepts instances of Function")}this._all.push(fn)};return EventEmitter}();function createTrack(BDLynxModule,cardSetTimeout){var track=function(tag,info){var data={tag:tag,data:__assign(__assign({},info),{lib_version:"1.4.0.1"})};BDLynxModule.invoke("systemLog",data,noop)};track.debounce=debounce(track,500,cardSetTimeout);return track}var freeGlobal=typeof global=="object"&&global&&global.Object===Object&&global;var freeSelf=typeof self=="object"&&self&&self.Object===Object&&self;var root=freeGlobal||freeSelf||Function("return this")();var Symbol$1=root.Symbol;var objectProto=Object.prototype;var hasOwnProperty=objectProto.hasOwnProperty;var nativeObjectToString=objectProto.toString;var symToStringTag=Symbol$1?Symbol$1.toStringTag:undefined;function getRawTag(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=undefined;var unmasked=true}catch(e){}var result=nativeObjectToString.call(value);if(unmasked){if(isOwn){value[symToStringTag]=tag}else{delete value[symToStringTag]}}return result}var objectProto$1=Object.prototype;var nativeObjectToString$1=objectProto$1.toString;function objectToString(value){return nativeObjectToString$1.call(value)}var nullTag="[object Null]",undefinedTag="[object Undefined]";var symToStringTag$1=Symbol$1?Symbol$1.toStringTag:undefined;function baseGetTag(value){if(value==null){return value===undefined?undefinedTag:nullTag}return symToStringTag$1&&symToStringTag$1 in Object(value)?getRawTag(value):objectToString(value)}function isObjectLike(value){return value!=null&&typeof value=="object"}var symbolTag="[object Symbol]";function isSymbol(value){return typeof value=="symbol"||isObjectLike(value)&&baseGetTag(value)==symbolTag}function arrayMap(array,iteratee){var index=-1,length=array==null?0:array.length,result=Array(length);while(++index<length){result[index]=iteratee(array[index],index,array)}return result}var isArray$1=Array.isArray;var INFINITY=1/0;var symbolProto=Symbol$1?Symbol$1.prototype:undefined,symbolToString=symbolProto?symbolProto.toString:undefined;function baseToString(value){if(typeof value=="string"){return value}if(isArray$1(value)){return arrayMap(value,baseToString)+""}if(isSymbol(value)){return symbolToString?symbolToString.call(value):""}var result=value+"";return result=="0"&&1/value==-INFINITY?"-0":result}function isObject$1(value){var type=typeof value;return value!=null&&(type=="object"||type=="function")}function identity(value){return value}var asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(value){if(!isObject$1(value)){return false}var tag=baseGetTag(value);return tag==funcTag||tag==genTag||tag==asyncTag||tag==proxyTag}var coreJsData=root["__core-js_shared__"];var maskSrcKey=function(){var uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return uid?"Symbol(src)_1."+uid:""}();function isMasked(func){return!!maskSrcKey&&maskSrcKey in func}var funcProto=Function.prototype;var funcToString=funcProto.toString;function toSource(func){if(func!=null){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g;var reIsHostCtor=/^\[object .+?Constructor\]$/;var funcProto$1=Function.prototype,objectProto$2=Object.prototype;var funcToString$1=funcProto$1.toString;var hasOwnProperty$1=objectProto$2.hasOwnProperty;var reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(value){if(!isObject$1(value)||isMasked(value)){return false}var pattern=isFunction(value)?reIsNative:reIsHostCtor;return pattern.test(toSource(value))}function getValue(object,key){return object==null?undefined:object[key]}function getNative(object,key){var value=getValue(object,key);return baseIsNative(value)?value:undefined}var WeakMap$1=getNative(root,"WeakMap");var objectCreate=Object.create;var baseCreate=function(){function object(){}return function(proto){if(!isObject$1(proto)){return{}}if(objectCreate){return objectCreate(proto)}object.prototype=proto;var result=new object;object.prototype=undefined;return result}}();function copyArray(source,array){var index=-1,length=source.length;array||(array=Array(length));while(++index<length){array[index]=source[index]}return array}var defineProperty=function(){try{var func=getNative(Object,"defineProperty");func({},"",{});return func}catch(e){}}();function arrayEach(array,iteratee){var index=-1,length=array==null?0:array.length;while(++index<length){if(iteratee(array[index],index,array)===false){break}}return array}var MAX_SAFE_INTEGER=9007199254740991;var reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(value,length){var type=typeof value;length=length==null?MAX_SAFE_INTEGER:length;return!!length&&(type=="number"||type!="symbol"&&reIsUint.test(value))&&(value>-1&&value%1==0&&value<length)}function baseAssignValue(object,key,value){if(key=="__proto__"&&defineProperty){defineProperty(object,key,{"configurable":true,"enumerable":true,"value":value,"writable":true})}else{object[key]=value}}function eq(value,other){return value===other||value!==value&&other!==other}var objectProto$3=Object.prototype;var hasOwnProperty$2=objectProto$3.hasOwnProperty;function assignValue(object,key,value){var objValue=object[key];if(!(hasOwnProperty$2.call(object,key)&&eq(objValue,value))||value===undefined&&!(key in object)){baseAssignValue(object,key,value)}}function copyObject(source,props,object,customizer){var isNew=!object;object||(object={});var index=-1,length=props.length;while(++index<length){var key=props[index];var newValue=customizer?customizer(object[key],source[key],key,object,source):undefined;if(newValue===undefined){newValue=source[key]}if(isNew){baseAssignValue(object,key,newValue)}else{assignValue(object,key,newValue)}}return object}var MAX_SAFE_INTEGER$1=9007199254740991;function isLength(value){return typeof value=="number"&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER$1}function isArrayLike(value){return value!=null&&isLength(value.length)&&!isFunction(value)}var objectProto$4=Object.prototype;function isPrototype(value){var Ctor=value&&value.constructor,proto=typeof Ctor=="function"&&Ctor.prototype||objectProto$4;return value===proto}function baseTimes(n,iteratee){var index=-1,result=Array(n);while(++index<n){result[index]=iteratee(index)}return result}var argsTag="[object Arguments]";function baseIsArguments(value){return isObjectLike(value)&&baseGetTag(value)==argsTag}var objectProto$5=Object.prototype;var hasOwnProperty$3=objectProto$5.hasOwnProperty;var propertyIsEnumerable=objectProto$5.propertyIsEnumerable;var isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty$3.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};function stubFalse(){return false}var freeExports=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule=freeExports&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports=freeModule&&freeModule.exports===freeExports;var Buffer=moduleExports?root.Buffer:undefined;var nativeIsBuffer=Buffer?Buffer.isBuffer:undefined;var isBuffer=nativeIsBuffer||stubFalse;var argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]";var arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]";var typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=true;typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=false;function baseIsTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}function baseUnary(func){return function(value){return func(value)}}var freeExports$1=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule$1=freeExports$1&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1;var freeProcess=moduleExports$1&&freeGlobal.process;var nodeUtil=function(){try{var types=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;if(types){return types}return freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();var nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray;var isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;var objectProto$6=Object.prototype;var hasOwnProperty$4=objectProto$6.hasOwnProperty;function arrayLikeKeys(value,inherited){var isArr=isArray$1(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value){if((inherited||hasOwnProperty$4.call(value,key))&&!(skipIndexes&&(key=="length"||isBuff&&(key=="offset"||key=="parent")||isType&&(key=="buffer"||key=="byteLength"||key=="byteOffset")||isIndex(key,length)))){result.push(key)}}return result}function overArg(func,transform){return function(arg){return func(transform(arg))}}var nativeKeys=overArg(Object.keys,Object);var objectProto$7=Object.prototype;var hasOwnProperty$5=objectProto$7.hasOwnProperty;function baseKeys(object){if(!isPrototype(object)){return nativeKeys(object)}var result=[];for(var key in Object(object)){if(hasOwnProperty$5.call(object,key)&&key!="constructor"){result.push(key)}}return result}function keys(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}function nativeKeysIn(object){var result=[];if(object!=null){for(var key in Object(object)){result.push(key)}}return result}var objectProto$8=Object.prototype;var hasOwnProperty$6=objectProto$8.hasOwnProperty;function baseKeysIn(object){if(!isObject$1(object)){return nativeKeysIn(object)}var isProto=isPrototype(object),result=[];for(var key in object){if(!(key=="constructor"&&(isProto||!hasOwnProperty$6.call(object,key)))){result.push(key)}}return result}function keysIn$1(object){return isArrayLike(object)?arrayLikeKeys(object,true):baseKeysIn(object)}var reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;function isKey(value,object){if(isArray$1(value)){return false}var type=typeof value;if(type=="number"||type=="symbol"||type=="boolean"||value==null||isSymbol(value)){return true}return reIsPlainProp.test(value)||!reIsDeepProp.test(value)||object!=null&&value in Object(object)}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{};this.size=0}function hashDelete(key){var result=this.has(key)&&delete this.__data__[key];this.size-=result?1:0;return result}var HASH_UNDEFINED="__lodash_hash_undefined__";var objectProto$9=Object.prototype;var hasOwnProperty$7=objectProto$9.hasOwnProperty;function hashGet(key){var data=this.__data__;if(nativeCreate){var result=data[key];return result===HASH_UNDEFINED?undefined:result}return hasOwnProperty$7.call(data,key)?data[key]:undefined}var objectProto$a=Object.prototype;var hasOwnProperty$8=objectProto$a.hasOwnProperty;function hashHas(key){var data=this.__data__;return nativeCreate?data[key]!==undefined:hasOwnProperty$8.call(data,key)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(key,value){var data=this.__data__;this.size+=this.has(key)?0:1;data[key]=nativeCreate&&value===undefined?HASH_UNDEFINED$1:value;return this}function Hash(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear;Hash.prototype["delete"]=hashDelete;Hash.prototype.get=hashGet;Hash.prototype.has=hashHas;Hash.prototype.set=hashSet;function listCacheClear(){this.__data__=[];this.size=0}function assocIndexOf(array,key){var length=array.length;while(length--){if(eq(array[length][0],key)){return length}}return-1}var arrayProto=Array.prototype;var splice=arrayProto.splice;function listCacheDelete(key){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){return false}var lastIndex=data.length-1;if(index==lastIndex){data.pop()}else{splice.call(data,index,1)}--this.size;return true}function listCacheGet(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?undefined:data[index][1]}function listCacheHas(key){return assocIndexOf(this.__data__,key)>-1}function listCacheSet(key,value){var data=this.__data__,index=assocIndexOf(data,key);if(index<0){++this.size;data.push([key,value])}else{data[index][1]=value}return this}function ListCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear;ListCache.prototype["delete"]=listCacheDelete;ListCache.prototype.get=listCacheGet;ListCache.prototype.has=listCacheHas;ListCache.prototype.set=listCacheSet;var Map$1=getNative(root,"Map");function mapCacheClear(){this.size=0;this.__data__={"hash":new Hash,"map":new(Map$1||ListCache),"string":new Hash}}function isKeyable(value){var type=typeof value;return type=="string"||type=="number"||type=="symbol"||type=="boolean"?value!=="__proto__":value===null}function getMapData(map,key){var data=map.__data__;return isKeyable(key)?data[typeof key=="string"?"string":"hash"]:data.map}function mapCacheDelete(key){var result=getMapData(this,key)["delete"](key);this.size-=result?1:0;return result}function mapCacheGet(key){return getMapData(this,key).get(key)}function mapCacheHas(key){return getMapData(this,key).has(key)}function mapCacheSet(key,value){var data=getMapData(this,key),size=data.size;data.set(key,value);this.size+=data.size==size?0:1;return this}function MapCache(entries){var index=-1,length=entries==null?0:entries.length;this.clear();while(++index<length){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear;MapCache.prototype["delete"]=mapCacheDelete;MapCache.prototype.get=mapCacheGet;MapCache.prototype.has=mapCacheHas;MapCache.prototype.set=mapCacheSet;var FUNC_ERROR_TEXT="Expected a function";function memoize(func,resolver){if(typeof func!="function"||resolver!=null&&typeof resolver!="function"){throw new TypeError(FUNC_ERROR_TEXT)}var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key)){return cache.get(key)}var result=func.apply(this,args);memoized.cache=cache.set(key,result)||cache;return result};memoized.cache=new(memoize.Cache||MapCache);return memoized}memoize.Cache=MapCache;var MAX_MEMOIZE_SIZE=500;function memoizeCapped(func){var result=memoize(func,(function(key){if(cache.size===MAX_MEMOIZE_SIZE){cache.clear()}return key}));var cache=result.cache;return result}var rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var reEscapeChar=/\\(\\)?/g;var stringToPath=memoizeCapped((function(string){var result=[];if(string.charCodeAt(0)===46){result.push("")}string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)}));return result}));function toString(value){return value==null?"":baseToString(value)}function castPath(value,object){if(isArray$1(value)){return value}return isKey(value,object)?[value]:stringToPath(toString(value))}var INFINITY$1=1/0;function toKey(value){if(typeof value=="string"||isSymbol(value)){return value}var result=value+"";return result=="0"&&1/value==-INFINITY$1?"-0":result}function baseGet(object,path){path=castPath(path,object);var index=0,length=path.length;while(object!=null&&index<length){object=object[toKey(path[index++])]}return index&&index==length?object:undefined}function get(object,path,defaultValue){var result=object==null?undefined:baseGet(object,path);return result===undefined?defaultValue:result}function arrayPush(array,values){var index=-1,length=values.length,offset=array.length;while(++index<length){array[offset+index]=values[index]}return array}var getPrototype=overArg(Object.getPrototypeOf,Object);function stackClear(){this.__data__=new ListCache;this.size=0}function stackDelete(key){var data=this.__data__,result=data["delete"](key);this.size=data.size;return result}function stackGet(key){return this.__data__.get(key)}function stackHas(key){return this.__data__.has(key)}var LARGE_ARRAY_SIZE=200;function stackSet(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map$1||pairs.length<LARGE_ARRAY_SIZE-1){pairs.push([key,value]);this.size=++data.size;return this}data=this.__data__=new MapCache(pairs)}data.set(key,value);this.size=data.size;return this}function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear;Stack.prototype["delete"]=stackDelete;Stack.prototype.get=stackGet;Stack.prototype.has=stackHas;Stack.prototype.set=stackSet;function baseAssign(object,source){return object&&copyObject(source,keys(source),object)}function baseAssignIn(object,source){return object&&copyObject(source,keysIn$1(source),object)}var freeExports$2=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var freeModule$2=freeExports$2&&typeof module=="object"&&module&&!module.nodeType&&module;var moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2;var Buffer$1=moduleExports$2?root.Buffer:undefined,allocUnsafe=Buffer$1?Buffer$1.allocUnsafe:undefined;function cloneBuffer(buffer,isDeep){if(isDeep){return buffer.slice()}var length=buffer.length,result=allocUnsafe?allocUnsafe(length):new buffer.constructor(length);buffer.copy(result);return result}function arrayFilter(array,predicate){var index=-1,length=array==null?0:array.length,resIndex=0,result=[];while(++index<length){var value=array[index];if(predicate(value,index,array)){result[resIndex++]=value}}return result}function stubArray(){return[]}var objectProto$b=Object.prototype;var propertyIsEnumerable$1=objectProto$b.propertyIsEnumerable;var nativeGetSymbols=Object.getOwnPropertySymbols;var getSymbols=!nativeGetSymbols?stubArray:function(object){if(object==null){return[]}object=Object(object);return arrayFilter(nativeGetSymbols(object),(function(symbol){return propertyIsEnumerable$1.call(object,symbol)}))};function copySymbols(source,object){return copyObject(source,getSymbols(source),object)}var nativeGetSymbols$1=Object.getOwnPropertySymbols;var getSymbolsIn=!nativeGetSymbols$1?stubArray:function(object){var result=[];while(object){arrayPush(result,getSymbols(object));object=getPrototype(object)}return result};function copySymbolsIn(source,object){return copyObject(source,getSymbolsIn(source),object)}function baseGetAllKeys(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray$1(object)?result:arrayPush(result,symbolsFunc(object))}function getAllKeys(object){return baseGetAllKeys(object,keys,getSymbols)}function getAllKeysIn(object){return baseGetAllKeys(object,keysIn$1,getSymbolsIn)}var DataView=getNative(root,"DataView");var Promise$1=getNative(root,"Promise");var Set=getNative(root,"Set");var mapTag$1="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$1="[object Set]",weakMapTag$1="[object WeakMap]";var dataViewTag$1="[object DataView]";var dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map$1),promiseCtorString=toSource(Promise$1),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap$1);var getTag=baseGetTag;if(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag$1||Map$1&&getTag(new Map$1)!=mapTag$1||Promise$1&&getTag(Promise$1.resolve())!=promiseTag||Set&&getTag(new Set)!=setTag$1||WeakMap$1&&getTag(new WeakMap$1)!=weakMapTag$1){getTag=function(value){var result=baseGetTag(value),Ctor=result==objectTag$1?value.constructor:undefined,ctorString=Ctor?toSource(Ctor):"";if(ctorString){switch(ctorString){case dataViewCtorString:return dataViewTag$1;case mapCtorString:return mapTag$1;case promiseCtorString:return promiseTag;case setCtorString:return setTag$1;case weakMapCtorString:return weakMapTag$1}}return result}}var getTag$1=getTag;var objectProto$c=Object.prototype;var hasOwnProperty$9=objectProto$c.hasOwnProperty;function initCloneArray(array){var length=array.length,result=new array.constructor(length);if(length&&typeof array[0]=="string"&&hasOwnProperty$9.call(array,"index")){result.index=array.index;result.input=array.input}return result}var Uint8Array$1=root.Uint8Array;function cloneArrayBuffer(arrayBuffer){var result=new arrayBuffer.constructor(arrayBuffer.byteLength);new Uint8Array$1(result).set(new Uint8Array$1(arrayBuffer));return result}function cloneDataView(dataView,isDeep){var buffer=isDeep?cloneArrayBuffer(dataView.buffer):dataView.buffer;return new dataView.constructor(buffer,dataView.byteOffset,dataView.byteLength)}var reFlags=/\w*$/;function cloneRegExp(regexp){var result=new regexp.constructor(regexp.source,reFlags.exec(regexp));result.lastIndex=regexp.lastIndex;return result}var symbolProto$1=Symbol$1?Symbol$1.prototype:undefined,symbolValueOf=symbolProto$1?symbolProto$1.valueOf:undefined;function cloneSymbol(symbol){return symbolValueOf?Object(symbolValueOf.call(symbol)):{}}function cloneTypedArray(typedArray,isDeep){var buffer=isDeep?cloneArrayBuffer(typedArray.buffer):typedArray.buffer;return new typedArray.constructor(buffer,typedArray.byteOffset,typedArray.length)}var boolTag$1="[object Boolean]",dateTag$1="[object Date]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]";var arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$2="[object DataView]",float32Tag$1="[object Float32Array]",float64Tag$1="[object Float64Array]",int8Tag$1="[object Int8Array]",int16Tag$1="[object Int16Array]",int32Tag$1="[object Int32Array]",uint8Tag$1="[object Uint8Array]",uint8ClampedTag$1="[object Uint8ClampedArray]",uint16Tag$1="[object Uint16Array]",uint32Tag$1="[object Uint32Array]";function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag$1:return cloneArrayBuffer(object);case boolTag$1:case dateTag$1:return new Ctor(+object);case dataViewTag$2:return cloneDataView(object,isDeep);case float32Tag$1:case float64Tag$1:case int8Tag$1:case int16Tag$1:case int32Tag$1:case uint8Tag$1:case uint8ClampedTag$1:case uint16Tag$1:case uint32Tag$1:return cloneTypedArray(object,isDeep);case mapTag$2:return new Ctor;case numberTag$1:case stringTag$1:return new Ctor(object);case regexpTag$1:return cloneRegExp(object);case setTag$2:return new Ctor;case symbolTag$1:return cloneSymbol(object)}}function initCloneObject(object){return typeof object.constructor=="function"&&!isPrototype(object)?baseCreate(getPrototype(object)):{}}var mapTag$3="[object Map]";function baseIsMap(value){return isObjectLike(value)&&getTag$1(value)==mapTag$3}var nodeIsMap=nodeUtil&&nodeUtil.isMap;var isMap=nodeIsMap?baseUnary(nodeIsMap):baseIsMap;var setTag$3="[object Set]";function baseIsSet(value){return isObjectLike(value)&&getTag$1(value)==setTag$3}var nodeIsSet=nodeUtil&&nodeUtil.isSet;var isSet=nodeIsSet?baseUnary(nodeIsSet):baseIsSet;var CLONE_DEEP_FLAG=1,CLONE_FLAT_FLAG=2,CLONE_SYMBOLS_FLAG=4;var argsTag$2="[object Arguments]",arrayTag$1="[object Array]",boolTag$2="[object Boolean]",dateTag$2="[object Date]",errorTag$1="[object Error]",funcTag$2="[object Function]",genTag$1="[object GeneratorFunction]",mapTag$4="[object Map]",numberTag$2="[object Number]",objectTag$2="[object Object]",regexpTag$2="[object RegExp]",setTag$4="[object Set]",stringTag$2="[object String]",symbolTag$2="[object Symbol]",weakMapTag$2="[object WeakMap]";var arrayBufferTag$2="[object ArrayBuffer]",dataViewTag$3="[object DataView]",float32Tag$2="[object Float32Array]",float64Tag$2="[object Float64Array]",int8Tag$2="[object Int8Array]",int16Tag$2="[object Int16Array]",int32Tag$2="[object Int32Array]",uint8Tag$2="[object Uint8Array]",uint8ClampedTag$2="[object Uint8ClampedArray]",uint16Tag$2="[object Uint16Array]",uint32Tag$2="[object Uint32Array]";var cloneableTags={};cloneableTags[argsTag$2]=cloneableTags[arrayTag$1]=cloneableTags[arrayBufferTag$2]=cloneableTags[dataViewTag$3]=cloneableTags[boolTag$2]=cloneableTags[dateTag$2]=cloneableTags[float32Tag$2]=cloneableTags[float64Tag$2]=cloneableTags[int8Tag$2]=cloneableTags[int16Tag$2]=cloneableTags[int32Tag$2]=cloneableTags[mapTag$4]=cloneableTags[numberTag$2]=cloneableTags[objectTag$2]=cloneableTags[regexpTag$2]=cloneableTags[setTag$4]=cloneableTags[stringTag$2]=cloneableTags[symbolTag$2]=cloneableTags[uint8Tag$2]=cloneableTags[uint8ClampedTag$2]=cloneableTags[uint16Tag$2]=cloneableTags[uint32Tag$2]=true;cloneableTags[errorTag$1]=cloneableTags[funcTag$2]=cloneableTags[weakMapTag$2]=false;function baseClone(value,bitmask,customizer,key,object,stack){var result,isDeep=bitmask&CLONE_DEEP_FLAG,isFlat=bitmask&CLONE_FLAT_FLAG,isFull=bitmask&CLONE_SYMBOLS_FLAG;if(customizer){result=object?customizer(value,key,object,stack):customizer(value)}if(result!==undefined){return result}if(!isObject$1(value)){return value}var isArr=isArray$1(value);if(isArr){result=initCloneArray(value);if(!isDeep){return copyArray(value,result)}}else{var tag=getTag$1(value),isFunc=tag==funcTag$2||tag==genTag$1;if(isBuffer(value)){return cloneBuffer(value,isDeep)}if(tag==objectTag$2||tag==argsTag$2||isFunc&&!object){result=isFlat||isFunc?{}:initCloneObject(value);if(!isDeep){return isFlat?copySymbolsIn(value,baseAssignIn(result,value)):copySymbols(value,baseAssign(result,value))}}else{if(!cloneableTags[tag]){return object?value:{}}result=initCloneByTag(value,tag,isDeep)}}stack||(stack=new Stack);var stacked=stack.get(value);if(stacked){return stacked}stack.set(value,result);if(isSet(value)){value.forEach((function(subValue){result.add(baseClone(subValue,bitmask,customizer,subValue,value,stack))}))}else if(isMap(value)){value.forEach((function(subValue,key){result.set(key,baseClone(subValue,bitmask,customizer,key,value,stack))}))}var keysFunc=isFull?isFlat?getAllKeysIn:getAllKeys:isFlat?keysIn:keys;var props=isArr?undefined:keysFunc(value);arrayEach(props||value,(function(subValue,key){if(props){key=subValue;subValue=value[key]}assignValue(result,key,baseClone(subValue,bitmask,customizer,key,value,stack))}));return result}var CLONE_DEEP_FLAG$1=1,CLONE_SYMBOLS_FLAG$1=4;function cloneDeep(value){return baseClone(value,CLONE_DEEP_FLAG$1|CLONE_SYMBOLS_FLAG$1)}function hasPath(object,path,hasFunc){path=castPath(path,object);var index=-1,length=path.length,result=false;while(++index<length){var key=toKey(path[index]);if(!(result=object!=null&&hasFunc(object,key))){break}object=object[key]}if(result||++index!=length){return result}length=object==null?0:object.length;return!!length&&isLength(length)&&isIndex(key,length)&&(isArray$1(object)||isArguments(object))}var objectProto$d=Object.prototype;var hasOwnProperty$a=objectProto$d.hasOwnProperty;function baseHas(object,key){return object!=null&&hasOwnProperty$a.call(object,key)}function has(object,path){return object!=null&&hasPath(object,path,baseHas)}function baseSum(array,iteratee){var result,index=-1,length=array.length;while(++index<length){var current=iteratee(array[index]);if(current!==undefined){result=result===undefined?current:result+current}}return result}function baseSet(object,path,value,customizer){if(!isObject$1(object)){return object}path=castPath(path,object);var index=-1,length=path.length,lastIndex=length-1,nested=object;while(nested!=null&&++index<length){var key=toKey(path[index]),newValue=value;if(index!=lastIndex){var objValue=nested[key];newValue=customizer?customizer(objValue,key,nested):undefined;if(newValue===undefined){newValue=isObject$1(objValue)?objValue:isIndex(path[index+1])?[]:{}}}assignValue(nested,key,newValue);nested=nested[key]}return object}function set(object,path,value){return object==null?object:baseSet(object,path,value)}function sum(array){return array&&array.length?baseSum(array,identity):0}var APIKeyId={createRequestTask:1,operateRequestTask:2,createUploadTask:3,operateUploadTask:4,createDownloadTask:5,operateDownloadTask:6,setAudioState:7,getAudioState:8,operateAudio:9,createAudioInstance:10,destroyAudioInstance:11,operateRecorder:12,chooseVideo:13,saveVideoToPhotosAlbum:14,saveFile:15,getStorage:16,setStorage:17,removeStorage:18,removeStorageSync:19,clearStorage:20,getStorageInfo:21,getStorageInfoSync:22,openLocation:23,getSystemInfo:24,getSystemInfoSync:25,getNetworkType:26,getConnectedWifi:27,getClipboardData:28,setClipboardData:29,setKeepScreenOn:30,enableAccelerometer:31,vibrateShort:32,vibrateLong:33,showModal:34,showToast:35,hideToast:36,showActionSheet:37,redirectTo:38,reLaunch:39,navigateTo:40,switchTab:41,navigateBack:42,protocolPathToAbsPath:43,base64ToTempFilePath:44,makePhoneCall:45,login:46,checkSession:47,getUserInfo:48,getUseDuration:49,dealUserRelation:50,requestPayment:51,chooseAddress:52,setKeyboardValue:53,hideKeyboard:54,getCurrentRoute:55,getPhoneNumber:56,initReady:57,showKeyboard:58,showDatePickerView:59,insertVideoPlayer:60,removeVideoPlayer:61,webViewReadyToTerminate:62,getFileInfo:63,getSavedFileList:64,removeSavedFile:65,saveFileSync:66,readFile:67,readFileSync:68,writeFileSync:69,mkdirSync:70,readdirSync:71,rmdirSync:72,accessSync:73,unlinkSync:74,statSync:75,renameSync:76,copyFile:77,copyFileSync:78,unzip:79,getMenuButtonBoundingClientRect:80,updateKeyboard:81,exitMiniProgram:82,getLaunchOptionsSync:83,showShareMenu:84,hideShareMenu:85,getShareInfo:86,shareAppMessageDirectly:87,updateShareMenu:88,shareVideo:89,startCompass:90,stopCompass:91,startGameRecord:92,stopGameRecord:93,chooseImage:94,previewImage:95,getImageInfo:96,saveImageToPhotosAlbum:97,authorize:98,insertContainer:99,updateContainer:100,removeContainer:101,updateInput:102,clearStorageSync:103,showPickerView:104,showMultiPickerView:105,updateMultiPickerView:106,disableScrollBounce:107,removeTextArea:108,insertTextArea:109,updateTextArea:110,insertHTMLWebView:111,removeHTMLWebView:112,updateHTMLWebView:113,createSocketTask:114,operateSocketTask:115,getLocation:116,scanCode:117,startPullDownRefresh:118,stopPullDownRefresh:119,getSetting:120,openSetting:121,resumeGameRecord:122,getCloudStorageByRelation:123,getUserCloudStorage:124,removeUserCloudStorage:125,setUserCloudStorage:126,openUserProfile:127,pauseGameRecord:128,operateVideoAd:129,createVideoAd:130,getGeneralInfo:131,tma_login:132,openSchema:133,getVideoManager:134,createFaceDetector:135,requestCamera:136,createOffscreenVideo:137,reportAnalytics:138,requestGamePayment:139,operateScreenRecorder:140,_webviewGetPhoneNumber:141,_serviceGetPhoneNumber:142,setUserGroup:143,getCloudStorageByLocation:144,createFollowButton:145,operateFollowButton:146,writeFile:147,mkdir:148,rmdir:149,unlink:150,access:151,stat:152,rename:153,checkFollowState:154,getHostInfoSync:155,requestWXH5Payment:156,closeModalWebview:157,openModalWebview:158,hostLogin:159,getAppInfoSync:160,setTiming:161,systemLog:162,getStorageSync:163,setStorageSync:164,navigateBackMiniProgram:165,navigateToMiniProgram:166,getUsageRecord:167,applyUpdate:168,createDownloadAppTask:169,operateDownloadAppTask:170,getDownloadAppTaskStatusSync:171,getExtConfig:172,getExtConfigSync:173,createInnerRequestTask:174,operateInnerRequestTask:175,setRankData:176,getRankData:177,createBannerAd:178,updateBannerAd:179,operateBannerAd:180,createMoreGamesButton:181,operateMoreGamesButton:182,compressImage:183,chooseLocation:184,openDocument:185,showMoreGamesModal:186,getFavoritesList:187,addToFavorites:188,removeFromFavorites:189,sortFavorites:190,measureText:191,insertAdContainer:192,removeAdContainer:193,updateAdContainer:194,showRegionPickerView:195,showTextAreaKeyboard:196,operateVideoContext:197,updateVideoPlayer:198,endEditing:199,getLeftMenuButtonBoundingClientRect:200,preloadMiniProgram:201,navigateToVideoView:202,addAudioTrack:203,showFavoriteGuide:204,addToUserFavorites:205,showMorePanel:206,setMenuButtonVisibility:207,isInUserFavoritesSync:208,onBeforeCloseReturnSync:209,checkShortcut:210,setTabBarBadge:211,removeTabBarBadge:212,showTabBarRedDot:213,hideTabBarRedDot:214,showTabBar:215,hideTabBar:216,setTabBarItem:217,setTabBarStyle:218,onAppShow:219,offAppShow:220,onAppHide:221,offAppHide:222,onError:223,offError:224,showSuspendDialog:225,showNavigationBarLoading:226,hideNavigationBarLoading:227,hideHomeButton:228,openCustomerService:229,getWifiList:230,operateInterstitialAd:231,operateInternalStorageSync:232,operateInteractiveButton:233,createInteractiveButton:234,reportAppLog:235,createConcatButton:236,getAdSiteBaseInfo:237,startFacialRecognitionVerify:238,getVolumeControlStream:239,setVolumeControlStream:240,showInteractionBar:241,hideInteractionBar:242,getRenderEnvSync:243,getPerformanceTimingSync:244,getMoreGamesInfo:245,operateGameBanner:246,requestSubscribeMessage:247,insertMapContext:248,updateMapContext:249,removeMapContext:250,getCenterLocation:251,moveToLocation:252,getRegion:253,getScale:254,addShortcut:255,checkFollowAwemeState:256,openAwemeUserProfile:257,sendUmengEventV1:258,getLocalPhoneNumber:259,getLocalPhoneNumberToken:260,checkAppInstall:261,requestSafari:262,launchAppDirectly:263,insertCamera:264,updateCamera:265,removeCamera:266,startCameraFrame:267,stopCameraFrame:268,setCameraZoom:269,insertCanvas:270,updateCanvas:271,removeCanvas:272,createCanvasEnvSync:273,setBgAudioState:274,getBackgroundAudioContext:275,operateBgAudio:276,getBgAudioState:277,joinChatGroup:278,systemReport:279,setScreenBrightness:280,getScreenBrightness:281,authenticateRealName:282,openEcGood:283,openWebcastRoom:284,openDouyinOrderList:285};var Status;(function(Status){Status[Status["success"]=1]="success";Status[Status["fail"]=2]="fail";Status[Status["cancel"]=3]="cancel"})(Status||(Status={}));function createTrackAPI(track,cardSetTimeout){var hoardings={success:{},fail:{},cancel:{}};var batch=function(status,hoarding){var result=Object.entries(hoarding).map((function(_a){var _b=__read(_a,2),apiName=_b[0],item=_b[1];return Object.entries(item).map((function(_a){var _b;var _c=__read(_a,2),errMsg=_c[0],durations=_c[1];var count=durations.length;var average=sum(durations)/count;var apiId=(_b=APIKeyId[apiName])!==null&&_b!==void 0?_b:-1;var tail=errMsg.replace(apiName,"");return[apiId,status,count,average,tail].join("|")}))}));return result.flat()};var batchTrack=throttle((function(){var dataArray=__spread(batch(Status.success,hoardings.success),batch(Status.fail,hoardings.fail),batch(Status.cancel,hoardings.cancel));if(dataArray.length>0){hoardings.success={};hoardings.fail={};hoardings.cancel={};track("mp_api_analysis",{api_data_array:dataArray})}}),30*1e3,cardSetTimeout);var trackAPI=function(apiName,options){var path=[options.status,apiName,options.errMsg];if(!has(hoardings,path)){set(hoardings,path,[])}var durations=get(hoardings,path);durations.push(options.duration);batchTrack()};return trackAPI}function createTracks(BDLynxModule,cardSetTimeout){var track=createTrack(BDLynxModule,cardSetTimeout);var trackAPI=createTrackAPI(track,cardSetTimeout);return{track:track,trackAPI:trackAPI}}function reportNetworkAPI(method,url,options,cardProxyObj){var track=createTracks(cardProxyObj.BDLynxModule,cardProxyObj.setTimeout).track;var params=options.params,response=options.response,startTime=options.startTime,endTime=options.endTime;var _a=response.errMsg,errMsg=_a===void 0?"":_a;var duration=endTime-startTime;track("mp_net_request_result",{duration:duration,request_type:method,url:url.split("?")[0],result:options.state,error_msg:options.state==="fail"?errMsg:"",use_prefetch_cache:params.usePrefetchCache?1:0,is_prefetch:response.isPrefetch?1:0})}function reportPaymentAPI(method,options,cardProxyObj){var track=createTracks(cardProxyObj.BDLynxModule,cardProxyObj.setTimeout).track;if(options.state==="before"){var params=options.params;track("mp_payment_result",{payment_type:method,result:options.state,params:params})}else{var params=options.params,response=options.response,startTime=options.startTime,endTime=options.endTime;var _a=response.errMsg,errMsg=_a===void 0?"":_a;var duration=endTime-startTime;track("mp_payment_result",{duration:duration,payment_type:method,result:options.state,error_msg:options.state==="fail"?errMsg:"",params:params})}}var requestTaskIdStore=new WeakMap;var requestStatusStore=new WeakMap;var requestParamStore=new WeakMap;var requestCreateTimeStore=new WeakMap;var requestInstances={};var emitter=new EventEmitter;function createRequestTask(){var that=this;var param=requestParamStore.get(this);var cardProxyObj=param.cardProxyObj,cb=param.cb,params=__rest(param,["cardProxyObj","cb"]);requestStatusStore.set(this,"sending");var startTime=Date.now();requestCreateTimeStore.set(this,startTime);params=__assign(__assign({},params),{header2:Object.keys(param.header).map((function(k){return[k,String(param.header[k])]})),usePrefetchCache:param.usePrefetchCache||false});var createMethod=that.is_verify?"createVerifyRequestTask":that.is_inner?"createInnerRequestTask":"createRequestTask";var requestMethod=that.is_verify?"verifyRequest":that.is_inner?"innerRequest":"request";nativeInvoke(cardProxyObj._appInstance,createMethod,params,(function(res){var errMsg=res.errMsg;if(errMsg.startsWith(createMethod+":ok")){requestTaskIdStore.set(that,res.requestTaskId);requestInstances[res.requestTaskId]=that}else if(errMsg.startsWith(createMethod+":fail")){var result={errMsg:errMsg.replace("createRequestTask","request").replace("createVerifyRequestTask","verifyRequest").replace("createInnerRequestTask","innerRequest")};var endTime=Date.now();reportNetworkAPI("request",param.url,{state:"fail",startTime:startTime,endTime:endTime,params:param,response:res,requestId:res.requestTaskId},cardProxyObj);cb(result)}requestStatusStore.set(that,"done")}));emitter.addListener(requestTaskIdStore.get(that)+"success",(function(res){nativeConsole.log("emitter.on listener success",JSON.stringify(res));res.errMsg=requestMethod+":ok";if(typeof res.data==="string"&&res.data.charCodeAt(0)===65279){res.data=res.data.substr(1)}if(param.dataType==="json"&&typeof res.data==="string"){try{res.data=JSON.parse(res.data)}catch(e){nativeConsole.log(createMethod+" "+requestTaskIdStore.get(that)+" JSON.parse error: "+(e.message,e.stack))}}if(param.responseType==="arraybuffer"){res=NativeBuffer.unpack(res)}res.statusCode=parseInt(res.statusCode,10);if(typeof res.header==="object"){res.header=Object.keys(res.header).reduce((function(obj,key){Array.isArray(res.header[key])?obj[key]=res.header[key].join(","):typeof res.header[key]==="string"&&(obj[key]=res.header[key]);return obj}),{})}cb(res)}));emitter.addListener(requestTaskIdStore.get(that)+"fail",(function(res){nativeConsole.log("emitter.on listener fail",JSON.stringify(res));res.errMsg=requestMethod+":fail "+res.errMsg;cb(res)}))}function registerRequestEvent(BDLynxAPIModule){["onRequestTaskStateChange","onVerifyRequestTaskStateChange","onInnerRequestTaskStateChange"].forEach((function(value){BDLynxAPIModule.addListener(value,(function(res){var state=res.state,taskId=res.requestTaskId;delete res.state;delete res.requestTaskId;if(state==="success"||state==="fail"){emitter.trigger(String(taskId)+state,res);var task=requestInstances[taskId];if(task){try{var param=requestParamStore.get(task);var startTime=requestCreateTimeStore.get(task);reportNetworkAPI("request",param.url,{state:state,params:param,response:res,startTime:startTime,endTime:Date.now(),requestId:taskId},param.cardProxyObj)}catch(_a){}delete requestInstances[taskId];emitter.removeAllListeners(taskId+"success");emitter.removeAllListeners(taskId+"fail")}}}))}))}var Request=function(){function Request(param){this.is_verify=param.is_verify||false;this.is_inner=param.is_inner||false;requestStatusStore.set(this,"waiting");requestParamStore.set(this,param);createRequestTask.call(this)}Request.prototype.abort=function(){var that=this;nativeConsole.log("call abort");if(requestStatusStore.get(that)==="waiting"){requestStatusStore.set(that,"done")}else{var cardProxyObj=requestParamStore.get(that).cardProxyObj;var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;var operateMethod=that.is_verify?"operateVerifyRequestTask":this.is_inner?"operateInnerRequestTask":"operateRequestTask";BDLynxModule.invoke(operateMethod,{requestTaskId:requestTaskIdStore.get(that),operationType:"abort"},(function(){}))}};return Request}();var collectError=false;function setCollect(flag){collectError=flag}var Validator=function(){function Validator(){this.errors=[];this.hasFallback=false;this.hasDefault=false;this._optional=false}Validator.prototype.fail=function(options){if(collectError){if(typeof options==="string"){this.errors.push(options)}else{var message=this.path+" should be "+options.expect;if(this._optional&&options.expect!=="undefined"){message+=" or undefined, "}else{message+=", "}message+="but got "+echo(options.actual);this.errors.push(message)}}return false};Validator.prototype.fallback=function(v){this.hasFallback=true;this._fallback=v;return this};Object.defineProperty(Validator.prototype,"fallbackValue",{get:function(){return cloneDeep(this._fallback)},enumerable:false,configurable:true});Validator.prototype.default=function(v){this.hasDefault=true;this._default=v;return this};Object.defineProperty(Validator.prototype,"defaultValue",{get:function(){return cloneDeep(this._default)},enumerable:false,configurable:true});Validator.prototype.optional=function(){this._optional=true;return this};return Validator}();function isNumber(x){return typeof x==="number"}function echo(x){var s=getType(x);switch(s){case"string":return'"'+x+'"';case"number":case"boolean":case"null":case"undefined":return String(x);default:return"a(n) "+s}}function getType(x){if(typeof x==="function")return"function";var type=Object.prototype.toString.call(x).slice(8).slice(0,-1);return type.toLowerCase()}var $number=function(_super){__extends($number,_super);function $number(){return _super!==null&&_super.apply(this,arguments)||this}$number.prototype.validate=function(x){if(this._optional&&x===undefined)return true;if(!isNumber(x)){return this.fail({expect:"number",actual:x})}if(isNumber(this._min)&&x<this._min){return this.fail("the length of "+this.path+" should be greater than or equal to "+this._min)}if(isNumber(this._max)&&x>this._max){return this.fail("the length of "+this.path+" should be less than or equal to "+this._max)}return true};$number.prototype.min=function(v){this._min=v;return this};$number.prototype.max=function(v){this._max=v;return this};return $number}(Validator);var $boolean=function(_super){__extends($boolean,_super);function $boolean(){return _super!==null&&_super.apply(this,arguments)||this}$boolean.prototype.validate=function(x){if(this._optional&&x===undefined)return true;if(typeof x!=="boolean"){return this.fail({expect:"boolean",actual:x})}return true};return $boolean}(Validator);var $string=function(_super){__extends($string,_super);function $string(){return _super!==null&&_super.apply(this,arguments)||this}$string.prototype.validate=function(x){if(this._optional&&x===undefined)return true;if(typeof x!=="string"){return this.fail({expect:"string",actual:x})}if(isNumber(this._maxLength)&&x.length>this._maxLength){return this.fail("the length of "+this.path+" should be less than or equal to "+this._maxLength)}if(isNumber(this._minLength)&&x.length<this._minLength){return this.fail("the length of "+this.path+" should be greater than or equal to "+this._minLength)}if(typeof this._pattern==="string"){var reg=new RegExp(this._pattern);if(!reg.test(x)){return this.fail(this.path+' should match pattern "'+this._pattern+'"')}}else if(this._pattern){if(!this._pattern.test(x)){return this.fail(this.path+' should match pattern "'+this._pattern.toString()+'"')}}return true};$string.prototype.minLength=function(len){this._minLength=len;return this};$string.prototype.maxLength=function(len){this._maxLength=len;return this};$string.prototype.pattern=function(patten){this._pattern=patten;return this};return $string}(Validator);var $symbol=function(_super){__extends($symbol,_super);function $symbol(){return _super!==null&&_super.apply(this,arguments)||this}$symbol.prototype.validate=function(x){if(this._optional&&x===undefined)return true;if(typeof x!=="symbol"){return this.fail({expect:"symbol",actual:x})}return true};return $symbol}(Validator);var $any=function(_super){__extends($any,_super);function $any(){return _super!==null&&_super.apply(this,arguments)||this}$any.prototype.validate=function(x){return true};return $any}(Validator);var $undefined=function(_super){__extends($undefined,_super);function $undefined(){return _super!==null&&_super.apply(this,arguments)||this}$undefined.prototype.validate=function(x){if(x!==undefined){return this.fail({expect:"undefined",actual:x})}return true};return $undefined}(Validator);var $null=function(_super){__extends($null,_super);function $null(){return _super!==null&&_super.apply(this,arguments)||this}$null.prototype.validate=function(x){if(this._optional&&x===undefined)return true;if(x!==null){return this.fail({expect:"null",actual:x})}return true};return $null}(Validator);var $function=function(_super){__extends($function,_super);function $function(){return _super!==null&&_super.apply(this,arguments)||this}$function.prototype.validate=function(x){if(this._optional&&x===undefined)return true;if(typeof x!=="function"){return this.fail({expect:"function",actual:x})}return true};return $function}(Validator);var $enum=function(_super){__extends($enum,_super);function $enum(){var _items=[];for(var _i=0;_i<arguments.length;_i++){_items[_i]=arguments[_i]}var _this=_super.call(this)||this;_this._items=_items;return _this}$enum.prototype.validate=function(x){if(this._optional&&x===undefined)return true;if(!this._items.includes(x)){var enums=this._items.map((function(i){return JSON.stringify(i)})).join(", ");return this.fail("expect "+this.path+" to be one of "+enums+", but got "+echo(x))}return true};return $enum}(Validator);var $array=function(_super){__extends($array,_super);function $array(_item){var _this=_super.call(this)||this;_this._item=_item;return _this}$array.prototype.validate=function(x){var _this=this;if(this._optional&&x===undefined)return true;if(!Array.isArray(x)){return this.fail({expect:"array",actual:x})}if(isNumber(this._minItems)&&x.length<this._minItems){return this.fail("the length of "+this.path+" should be greater than or equal to "+this._minItems)}if(isNumber(this._maxItems)&&x.length>this._maxItems){return this.fail("the length of "+this.path+" should be less than or equal to "+this._maxItems)}var validator=this._item;if(!validator)return true;var result=true;x.forEach((function(item,index){validator.path=_this.path+"["+index+"]";validator.errors=_this.errors;if(item===undefined&&validator.hasDefault){x[index]=validator.defaultValue;return}if(!validator.validate(item)){if(validator.hasFallback){x[index]=validator.fallbackValue}else{result=false}}}));return result};$array.prototype.minItems=function(len){this._minItems=len;return this};$array.prototype.maxItems=function(len){this._maxItems=len;return this};return $array}(Validator);var $record=function(_super){__extends($record,_super);function $record(_value){var _this=_super.call(this)||this;_this._value=_value;return _this}$record.prototype.validate=function(x){if(this._optional&&x===undefined)return true;var type=getType(x);if(type!=="object"){return this.fail({expect:"object",actual:x})}var values=x;var validator=this._value;validator.errors=this.errors;var result=true;for(var k in values){var value=values[k];if(/^[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*$/.test(k)){validator.path=this.path+"."+k}else{validator.path=this.path+'["'+k+'"]'}if(value===undefined&&validator._optional){continue}if(value===undefined&&validator.hasDefault){values[k]=validator.defaultValue;continue}if(!validator.validate(value)){if(validator.hasFallback){values[k]=validator.fallbackValue}else{result=false}}}return result};return $record}(Validator);var $object=function(_super){__extends($object,_super);function $object(_object){if(_object===void 0){_object={}}var _this=_super.call(this)||this;_this._object=_object;return _this}$object.prototype.validate=function(x){if(this._optional&&x===undefined)return true;if(getType(x)!=="object"){return this.fail({expect:"object",actual:x})}var values=x;var result=true;for(var k in this._object){var value=values[k];var validator=this._object[k];validator.errors=this.errors;if(/^[_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*$/.test(k)){validator.path=this.path+"."+k}else{validator.path=this.path+'["'+k+'"]'}if(validator._optional&&value===undefined){continue}if(value===undefined&&validator.hasDefault){values[k]=validator.defaultValue;continue}if(!validator.validate(value)){if(validator.hasFallback){values[k]=validator.fallbackValue}else{result=false}}}return result};return $object}(Validator);var $literal=function(_super){__extends($literal,_super);function $literal(value){var _this=_super.call(this)||this;_this.value=value;return _this}$literal.prototype.validate=function(x){if(x===undefined&&this._optional)return true;if(x!==this.value){return this.fail({expect:echo(this.value),actual:x})}return true};return $literal}(Validator);var $or=function(_super){__extends($or,_super);function $or(){var _items=[];for(var _i=0;_i<arguments.length;_i++){_items[_i]=arguments[_i]}var _this=_super.call(this)||this;_this._items=_items;return _this}$or.prototype.validate=function(x){if(x===undefined&&this._optional)return true;var preErrors=this.errors;var orErrors=[];var result=false;var itemLength=this._items.length;for(var i=0;i<itemLength;i++){var validator=this._items[i];validator.errors=[];validator.path=this.path;if(!validator.validate(x)){orErrors.push(validator.errors.join("; "))}else if(!result){result=true;break}}if(!result){var grouped=orErrors.join("\nor ");this.errors=__spread(preErrors,[grouped])}else{this.errors=preErrors}return result};return $or}(Validator);var $tuple=function(_super){__extends($tuple,_super);function $tuple(){var _items=[];for(var _i=0;_i<arguments.length;_i++){_items[_i]=arguments[_i]}var _this=_super.call(this)||this;_this._items=_items;var optionalCount=0;var i=_items.length-1;for(;i>=0;i--){var validator=_items[i];if(validator._optional||validator.hasDefault){optionalCount+=1}else{break}}_this._minItems=_items.length-optionalCount;return _this}$tuple.prototype.validate=function(x){var _this=this;if(x===undefined&&this._optional)return true;if(!Array.isArray(x)){return this.fail({expect:"array",actual:x})}if(x.length<this._minItems){return this.fail("the length of "+this.path+" should be greater than or equal to "+this._minItems)}var result=true;this._items.forEach((function(validator,index){validator.path=_this.path+"["+index+"]";validator.errors=_this.errors;var item=x[index];if(item===undefined&&validator.hasDefault){x[index]=validator.defaultValue;return}if(!validator.validate(x[index])){if(validator.hasFallback){x[index]=validator._fallback}else{result=false}}}));return result};return $tuple}(Validator);var $arraybuffer=function(_super){__extends($arraybuffer,_super);function $arraybuffer(){return _super!==null&&_super.apply(this,arguments)||this}$arraybuffer.prototype.validate=function(x){if(x===undefined&&this._optional)return true;if(x instanceof ArrayBuffer){return true}return this.fail({expect:"arraybuffer",actual:x})};return $arraybuffer}(Validator);var t={object:function(schemas){return new $object(schemas)},array:function(schema){return new $array(schema)},tuple:function(){var _a;var schemas=[];for(var _i=0;_i<arguments.length;_i++){schemas[_i]=arguments[_i]}return new((_a=$tuple).bind.apply(_a,__spread([void 0],schemas)))},literal:function(v){return new $literal(v)},or:function(){var _a;var schemas=[];for(var _i=0;_i<arguments.length;_i++){schemas[_i]=arguments[_i]}return new((_a=$or).bind.apply(_a,__spread([void 0],schemas)))},symbol:function(){return new $symbol},record:function(schema){return new $record(schema)},function:function(){return new $function},boolean:function(){return new $boolean},string:function(){return new $string},number:function(){return new $number},undefined:function(){return new $undefined},null:function(){return new $null},unknown:function(){return new $any},any:function(){return new $any},as:function(){return new $any},arraybuffer:function(){return new $arraybuffer},enum:function(){var _a;var values=[];for(var _i=0;_i<arguments.length;_i++){values[_i]=arguments[_i]}return new((_a=$enum).bind.apply(_a,__spread([void 0],values)))}};function typeAsserts(validator,x,path){if(path===void 0){path="param"}validator.errors=[];validator.path=path;setCollect(true);if(!validator.validate(x)){var messages=validator.errors.join("\n");validator.errors.length=0;setCollect(false);throw new TypeError(messages)}}function createSyncAPI(method,config){return function(cardProxyObj){var inputs=[];for(var _i=1;_i<arguments.length;_i++){inputs[_i-1]=arguments[_i]}var startTime=Date.now();var trackAPI=createTracks(cardProxyObj.BDLynxModule,cardProxyObj.setTimeout).trackAPI;var status="success";var errMsg=method+":ok";if(config.paramsSchema){try{typeAsserts(config.paramsSchema,inputs,"inputs")}catch(err){throw new UserValidateError(method+":fail "+err.message)}}var _inputs=inputs;try{var res=config.implement.apply(config,__spread([cardProxyObj],_inputs));return res}catch(error){status="fail";errMsg=method+":"+status+" "+error.message.replace(/^\S+:(fail|cancel)\s?/,"");throw new Error(errMsg)}finally{trackAPI(method,{duration:Date.now()-startTime,errMsg:errMsg,status:status})}}}function createAPI(method,config){return function(cardProxyObj,_input){if(_input===void 0){_input={}}var input=isObject$1(_input)?_input:{};void function(){var startTime=Date.now();var trackAPI=createTracks(cardProxyObj.BDLynxModule,cardProxyObj.setTimeout).trackAPI;var params=input;var success=surroundByUserTryCatch(input.success,cardProxyObj._appInstance,"afterApiCall "+method);var fail=surroundByUserTryCatch(input.fail,cardProxyObj._appInstance,"afterApiCall "+method);var complete=surroundByUserTryCatch(input.complete,cardProxyObj._appInstance,"afterApiCall "+method);if(config.paramsSchema){try{typeAsserts(config.paramsSchema,params,"params")}catch(error){var errMsg=method+":fail "+error.message;var status="fail";var res={};res.errMsg=errMsg;trackAPI(method,{duration:Date.now()-startTime,errMsg:errMsg,status:status});fail.call(cardProxyObj._appInstance,res);complete.call(cardProxyObj._appInstance,res);return}}return config.implement(cardProxyObj,(function(res){var _a=parseApiRes(method,res,cardProxyObj._appInstance),errMsg=_a.errMsg,status=_a.status;if(typeof res==="string"){try{res=JSON.parse(res)}catch(e){reportError(new InternalRuntimeError("afterApiCall "+method+" JSON.parse error: "+e.message,e.stack),cardProxyObj._appInstance._nativeApp)}}if(status==="success"){success.call(cardProxyObj._appInstance,res)}else{fail.call(cardProxyObj._appInstance,res)}complete.call(cardProxyObj._appInstance,res);trackAPI(method,{duration:Date.now()-startTime,errMsg:errMsg,status:status})}),params!==null&&params!==void 0?params:{})}()}}var uploadTaskIdStore=new WeakMap;var uploadTaskParamStore=new WeakMap;var uploadInstances={};var emitter$1=new EventEmitter;function createUploadTask(){var that=this;var _a=uploadTaskParamStore.get(this),cardProxyObj=_a.cardProxyObj,cb=_a.cb,param=__rest(_a,["cardProxyObj","cb"]);param={url:param.url,header:param.header,filePath:param.filePath,name:param.name,formData:param.formData};nativeInvoke(cardProxyObj._appInstance,"createUploadTask",param,(function(res){var errMsg=res.errMsg;if(errMsg.startsWith("createUploadTask:ok")){uploadTaskIdStore.set(that,res.uploadTaskId);uploadInstances[res.uploadTaskId]=that}else if(errMsg.startsWith("createUploadTask:fail")){var result={errMsg:errMsg.replace("createUploadTask","uploadFile")};cb(result)}}));emitter$1.addListener(uploadTaskIdStore.get(that)+"success",(function(res){res.errMsg="uploadFile:ok";res.statusCode=parseInt(res.statusCode,10);![200,304].includes(res.statusCode)&&delete res.tempPath;cb(res)}));emitter$1.addListener(uploadTaskIdStore.get(that)+"fail",(function(res){res.errMsg="uploadFile:fail "+res.errMsg;cb(res)}))}function registerUploadEvent(BDLynxAPIModule){BDLynxAPIModule.addListener("onUploadTaskStateChange",(function(res){var state=res.state;var taskId=res.uploadTaskId;delete res.state;delete res.uploadTaskId;emitter$1.trigger(String(taskId)+state,res);if(state==="success"||state==="fail"){var task=uploadInstances[taskId];if(task){delete uploadInstances[taskId];emitter$1.removeAllListeners(taskId+"success");emitter$1.removeAllListeners(taskId+"fail");emitter$1.removeAllListeners(taskId+"progressUpdate")}}}))}var Upload=function(){function Upload(param){uploadTaskParamStore.set(this,param);createUploadTask.call(this)}Upload.prototype.abort=function(){var cardProxyObj=uploadTaskParamStore.get(this).cardProxyObj;var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("operateUploadTask",{uploadTaskId:uploadTaskIdStore.get(this),operationType:"abort"},(function(){}))};Upload.prototype.onProgressUpdate=function(callback){var cardProxyObj=uploadTaskParamStore.get(this).cardProxyObj;emitter$1.addListener(uploadTaskIdStore.get(this)+"progressUpdate",(function(t){typeof callback==="function"&&surroundByUserTryCatch(callback,cardProxyObj._appInstance,"onProgressUpdate")(t)}))};return Upload}();var uploadFile=createAPI("uploadFile",{paramsSchema:t.object({url:t.string(),filePath:t.string(),name:t.string(),header:t.object({}).default({"content-type":"multipart/form-data"}),formData:t.object().optional()}),implement:function(cardProxyObj,cb,params){var headerString=params.header?convertObjectValueToString(params.header):{};var formDataString=params.formData?convertObjectValueToString(params.formData):{};try{return new Upload(Object.assign({},params,{header:headerString,formData:formDataString,cardProxyObj:cardProxyObj,cb:cb}))}catch(ex){beforeInvokeFail("uploadFile",params,ex.message,cardProxyObj._appInstance)}}});var downloadTaskIdStore=new WeakMap;var downloadTaskStateStore=new WeakMap;var downloadTaskParamStore=new WeakMap;var downloadInstances={};var emitter$2=new EventEmitter;function createDownloadTask(){var that=this;var _a=downloadTaskParamStore.get(this),cardProxyObj=_a.cardProxyObj,cb=_a.cb,param=__rest(_a,["cardProxyObj","cb"]);downloadTaskStateStore.set(this,"sending");param={url:param.url,header:param.header};nativeInvoke(cardProxyObj._appInstance,"createDownloadTask",param,(function(res){var errMsg=res.errMsg;if(errMsg.startsWith("createDownloadTask:ok")){downloadTaskIdStore.set(that,res.downloadTaskId);downloadInstances[res.downloadTaskId]=that}else if(errMsg.startsWith("createDownloadTask:fail")){var result={errMsg:errMsg.replace("createDownloadTask","downloadFile")};cb(result)}downloadTaskStateStore.set(that,"done")}));emitter$2.addListener(downloadTaskIdStore.get(that)+"success",(function(res){res.errMsg="downloadFile:ok";res.statusCode=parseInt(res.statusCode,10);![200,304].includes(res.statusCode)&&delete res.tempPath;delete res.timeInterval;cb(res)}));emitter$2.addListener(downloadTaskIdStore.get(that)+"fail",(function(res){res.errMsg="downloadFile:fail "+res.errMsg;cb(res)}))}function registerDownloadEvent(BDLynxAPIModule){BDLynxAPIModule.addListener("onDownloadTaskStateChange",(function(res){if(typeof res==="string"){res=JSON.parse(res)}var state=res.state;var downloadTaskId=res.downloadTaskId;delete res.state;delete res.downloadTaskId;emitter$2.trigger(String(downloadTaskId)+state,res);if(state==="success"||state==="fail"){var task=downloadInstances[downloadTaskId];if(task){delete downloadInstances[downloadTaskId];emitter$2.removeAllListeners(downloadTaskId+"success");emitter$2.removeAllListeners(downloadTaskId+"fail");emitter$2.removeAllListeners(downloadTaskId+"progressUpdate")}}}))}var Download=function(){function Download(param){downloadTaskStateStore.set(this,"waiting");downloadTaskParamStore.set(this,param);createDownloadTask.call(this)}Download.prototype.abort=function(){var cardProxyObj=downloadTaskParamStore.get(this).cardProxyObj;var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("operateDownloadTask",{downloadTaskId:downloadTaskIdStore.get(this),operationType:"abort"},(function(){}))};Download.prototype.onProgressUpdate=function(cb){var cardProxyObj=downloadTaskParamStore.get(this).cardProxyObj;emitter$2.addListener(downloadTaskIdStore.get(this)+"progressUpdate",(function(res){typeof cb==="function"&&surroundByTryCatchFactory(cb,cardProxyObj._appInstance)(res)}))};return Download}();var downloadFile=createAPI("downloadFile",{paramsSchema:t.object({url:t.string(),header:t.object().optional()}),implement:function(cardProxyObj,cb,params){try{return new Download(__assign(__assign({},params),{cardProxyObj:cardProxyObj,cb:cb}))}catch(ex){beforeInvokeFail("downloadFile",params,ex.message,cardProxyObj._appInstance)}}});var taskIdStore=new WeakMap;var paramStore=new WeakMap;var socketTaskMap={};var emitter$3=new EventEmitter;function registerSocketEvent(BDLynxAPIModule){BDLynxAPIModule.addListener("onSocketTaskStateChange",(function(res){var state=res.state;var socketTaskId=res.socketTaskId;var task=socketTaskMap[socketTaskId];delete res.state;delete res.socketTaskId;if(task){state==="open"?task.readyState=task.OPEN:state!=="close"&&state!=="error"||(task.readyState=task.CLOSED);emitter$3.trigger(String(socketTaskId)+state,res);if(state==="close"){delete socketTaskMap[socketTaskId];emitter$3.removeAllListeners(socketTaskId+"open");emitter$3.removeAllListeners(socketTaskId+"close");emitter$3.removeAllListeners(socketTaskId+"error");emitter$3.removeAllListeners(socketTaskId+"message")}}}))}var listeneTaskStateChange=function(cmd,callback){var socketTaskId=taskIdStore.get(this);var cardProxyObj=paramStore.get(this).cardProxyObj;emitter$3.addListener(String(socketTaskId)+cmd,surroundByUserTryCatch(callback,cardProxyObj._appInstance,"listeneTaskStateChange"))};var SocketTask=function(){function SocketTask(param){var instance=this;var _a=param||{},cardProxyObj=_a.cardProxyObj,cb=_a.cb,params=__rest(_a,["cardProxyObj","cb"]);this.CONNECTING=0;this.OPEN=1;this.CLOSING=2;this.CLOSED=3;this.readyState=this.CONNECTING;paramStore.set(this,param);nativeInvoke(cardProxyObj._appInstance,"createSocketTask",params,(function(res){res.errMsg=res.errMsg.replace("createSocketTask","connectSocket");if(res.errMsg.startsWith("connectSocket:ok")){taskIdStore.set(instance,parseInt(res.socketTaskId,10));socketTaskMap[res.socketTaskId]=instance}else if(res.errMsg.startsWith("connectSocket:fail")){instance.readyState=instance.CLOSED}cb(res)}))}SocketTask.prototype.send=function(param){var cardProxyObj=paramStore.get(this).cardProxyObj;if(Object.prototype.toString.call(param.data)==="[object Object]"){param.data=JSON.stringify(param.data)}if(this.readyState===this.OPEN){nativeInvoke(cardProxyObj._appInstance,"operateSocketTask",__assign(__assign({},param),{operationType:"send",socketTaskId:taskIdStore.get(this)}),(function(res){res.errMsg=res.errMsg.replace("operateSocketTask","sendSocketMessage");afterApiCall("sendSocketMessage",res,param,cardProxyObj._appInstance)}))}else{beforeInvokeFail("SocketTask.send",param,"SocketTask.readState is not OPEN",cardProxyObj._appInstance)}};SocketTask.prototype.close=function(param){var cardProxyObj=paramStore.get(this).cardProxyObj;nativeInvoke(cardProxyObj._appInstance,"operateSocketTask",__assign(__assign({},param),{operationType:"close",code:1e3,socketTaskId:taskIdStore.get(this)}),(function(res){res.errMsg=res.errMsg.replace("operateSocketTask","closeSocket");afterApiCall("closeSocket",res,param,cardProxyObj._appInstance)}))};SocketTask.prototype.onOpen=function(cb){listeneTaskStateChange.call(this,"open",cb)};SocketTask.prototype.onClose=function(cb){listeneTaskStateChange.call(this,"close",cb)};SocketTask.prototype.onMessage=function(cb){listeneTaskStateChange.call(this,"message",cb)};SocketTask.prototype.onError=function(cb){listeneTaskStateChange.call(this,"error",cb)};return SocketTask}();var listeners=[];function registerNetworkEvent(BDLynxAPIModule){BDLynxAPIModule.addListener("onNetworkStatusChange",(function(res){nativeConsole.log("onNetworkStatusChange success",res);listeners.forEach((function(cb){typeof cb==="function"&&cb(res)}))}))}var getNetworkType=createAPI("getNetworkType",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("getNetworkType",params,cb)}});var getConnectedWifi=createAPI("getConnectedWifi",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("getConnectedWifi",params,cb)}});var onNetworkStatusChange=createSyncAPI("onNetworkStatusChange",{paramsSchema:t.tuple(t.unknown()),implement:function(cardProxyObj,callback){nativeConsole.log("push onNetworkStatusChange",callback);listeners.push(surroundByUserTryCatch(callback,cardProxyObj._appInstance,"tt.onNetworkStatusChange").bind(cardProxyObj._appInstance))}});var adDownloadMap=new Map;function registerAdDownloadEvent(BDLynxAPIModule){var onChangeApiName="onDownloadAppAdStatusChange";if(isAndroid()){onChangeApiName="onDxppAdStatusChange"}BDLynxAPIModule.addListener(onChangeApiName,(function(res){if(typeof res==="string"){res=JSON.parse(res)}var status=res.status,appad=res.appad;var adDownloadInstance=adDownloadMap.get(appad.download_url||appad.web_url);if(!adDownloadInstance)return;adDownloadInstance.emitter.emit(""+status,res);if(status==="download_finished"||status==="download_failed"||status==="unsubscribed"){adDownloadInstance.emitter.removeAllListeners("download_finished");adDownloadInstance.emitter.removeAllListeners("download_failed")}}))}var AdDownload=function(){function AdDownload(cardProxyObj,param,cb){adDownloadMap.set(param.download_url||param.web_url,this);this.cardProxyObj=cardProxyObj;this.emitter=new EventEmitter;["success","fail","complete"].forEach((function(func){typeof param[func]==="function"&&(param[func]=surroundByTryCatchFactory(param[func],cardProxyObj._appInstance,"at api adw-downloadFile "+func+" callback function"))}));var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("subscribeAppAd",param,cb);this.emitter.addListener("download_finished",(function(res){typeof param.success==="function"&&param.success(res);typeof param.complete==="function"&&param.complete(res)}));this.emitter.addListener("download_failed",(function(res){typeof param.fail==="function"&&param.fail(res);typeof param.complete==="function"&&param.complete(res)}))}AdDownload.prototype.onDownloadStatusChange=function(cb){var that=this;this.emitter.onAny((function(_,res){surroundByTryCatchFactory(cb,that.cardProxyObj._appInstance,"at DownloadTask.onDownloadStatusChange callback function")(res)}))};return AdDownload}();function AdDownloadFile(cardProxyObj,param,cb){try{return new AdDownload(cardProxyObj,param,cb)}catch(ex){beforeInvokeFail("subscribeAppAd",param,ex.message,cardProxyObj._appInstance)}}function registerNativeEvent(BDLynxAPIModule){registerRequestEvent(BDLynxAPIModule);registerUploadEvent(BDLynxAPIModule);registerDownloadEvent(BDLynxAPIModule);registerSocketEvent(BDLynxAPIModule);registerNetworkEvent(BDLynxAPIModule);registerAdDownloadEvent(BDLynxAPIModule)}var createSelectorQuery=createSyncAPI("createSelectorQuery",{implement:function(cardProxyObj){var NativeModules=cardProxyObj.NativeModules;var LynxUIMethodModule=(NativeModules||{}).LynxUIMethodModule;return new SelectorQuery(LynxUIMethodModule)}});var SelectorQuery=function(){function SelectorQuery(lynxUIMethodModule){this._lynxUIMethodModule=lynxUIMethodModule;this._component=null;this._queue=[]}SelectorQuery.prototype.in=function(component){if(typeof(component||{}).componentId==="string"){this._component=component}else{throw new Error("not a component.")}return this};SelectorQuery.prototype.select=function(selector){nativeConsole.log("createSelectorQuery select");return new NodesRef(this,this._component,selector)};SelectorQuery.prototype._push=function(selector,component,fields,actionType,callback){this._queue.push({component:component,selector:selector,fields:fields,actionType:actionType,callback:callback})};SelectorQuery.prototype.exec=function(cb){var that=this;nativeConsole.log("createSelectorQuery exec");var taskManager=that._queue.map((function(item){var component=item.component,selector=item.selector,actionType=item.actionType,callback=item.callback,fields=item.fields;var _a=(component||{}).componentId,componentId=_a===void 0?"":_a;return new Promise((function(resolve){that._lynxUIMethodModule.invokeUIMethod(componentId,[selector],actionType,fields,(function(res){var ret=res.code===0?res.data:null;if(typeof callback==="function"){callback(ret)}resolve(ret)}))}))}));if(typeof cb==="function"){Promise.all(taskManager).then((function(values){cb(values)})).catch((function(error){cb(error)}))}};return SelectorQuery}();var NodesRef=function(){function NodesRef(selectorQuery,component,selector){this._selectorQuery=selectorQuery;this._component=component;this._selector=selector}NodesRef.prototype.boundingClientRect=function(callback){this._selectorQuery._push(this._selector,this._component,{id:true,dataset:true,rect:true,size:true},"boundingClientRect",callback);return this._selectorQuery};return NodesRef}();var hostInfo,appInfo;var getHostInfoSync=createSyncAPI("getHostInfoSync",{implement:function(cardProxyObj){if(!checkObjectKeys(hostInfo)){hostInfo=cardProxyObj.NativeModules.BDLynxModule.invoke("getHostInfoSync",{},noop);if(typeof hostInfo==="string"){hostInfo=JSON.parse(hostInfo)}}return hostInfo}});var getGeneralInfo=createAPI("getGeneralInfo",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("getGeneralInfo",params,cb)}});var getAppInfoSync=createSyncAPI("getAppInfoSync",{implement:function(cardProxyObj){if(!checkObjectKeys(appInfo)){nativeInvoke(cardProxyObj._appInstance,"getAppInfoSync",{},(function(res){try{appInfo=__assign({},res);var query=deserialize(res.schema,false).query;appInfo.schemaQuery=__assign({},query)}catch(err){appInfo=null}}))}return appInfo}});var localLaunchOptions=null;var getLaunchOptionsSync=createSyncAPI("getLaunchOptionsSync",{implement:function(cardProxyObj){if(!localLaunchOptions){nativeInvoke(cardProxyObj._appInstance,"getLaunchOptionsSync",{},(function(res){try{if(res.errMsg==="getLaunchOptionsSync:ok"){localLaunchOptions=Object.assign({},res);if(typeof localLaunchOptions.query==="object"){for(var key in localLaunchOptions.query){localLaunchOptions.query[key]=decodeURIComponent(localLaunchOptions.query[key])}}else if(typeof localLaunchOptions.query==="string"){localLaunchOptions.query=JSON.parse(localLaunchOptions.query)}delete localLaunchOptions.errMsg}}catch(error){if(error instanceof URIError){throw new UserRuntimeError(JSON.stringify(localLaunchOptions.query))}throw error}}))}return localLaunchOptions}});var reportAnalytics=createSyncAPI("reportAnalytics",{paramsSchema:t.tuple(t.string(),t.object(),t.enum(0,1).optional().default(0)),implement:function(cardProxyObj,eventName,data,type){if(eventName.length>110){throw new ThirdScriptError("eventName exceeded the maximum length: 110.")}var keys=Object.keys(data);var mergeParams={value:{}};if(keys.length>256){throw new ThirdScriptError("data exceeded the maximum number of fields: 256.")}keys.filter((function(v){return!isObject(data[v])})).forEach((function(key){if(key.length>128){throw new ThirdScriptError(key+" exceeded the maximum number of bytes: 128.")}if(String(data[key]).length>1024){throw new ThirdScriptError("the value of data["+key+"] exceeded the maximum number of bytes: 1024.")}if((key===null||key===void 0?void 0:key.startsWith("_"))&&type!==1){throw new ThirdScriptError("the key first char can not be _.")}if((key==="mp_id"||key==="mp_name")&&type!==1){throw new ThirdScriptError("the key can not be mp_name or mp_id.")}mergeParams["value"][key]=data[key]}));var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("reportAnalytics",__assign(__assign({},mergeParams),{event:eventName,type:type}),noop)}});var sendLogV3=createSyncAPI("sendLogV3",{paramsSchema:t.tuple(t.string(),t.object()),implement:function(cardProxyObj,eventName,data){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("sendLogV3",{eventName:eventName,params:data},noop)}});var getStorage=createAPI("getStorage",{paramsSchema:t.object({key:t.string()}),implement:function(cardProxyObj,cb,params){nativeInvoke(cardProxyObj._appInstance,"getStorage",params,cb,{beforeSuccess:function(res){res.data=surroundByTryCatchFactory(_stringToAnyType,cardProxyObj._appInstance,"stringToAnyType")(res.data,res.dataType);delete res.dataType},afterFail:function(res){if(res===void 0){res={}}if(res.errMsg&&res.errMsg.indexOf("data not found")>0){return false}}})}});var getStorageSync=createSyncAPI("getStorageSync",{paramsSchema:t.tuple(t.string()),implement:function(cardProxyObj,key){var result;nativeInvoke(cardProxyObj._appInstance,"getStorageSync",{key:key},(function(res){result=surroundByTryCatchFactory(_stringToAnyType,cardProxyObj._appInstance,"stringToAnyType")(res.data,res.dataType)}));return result}});var setStorage=createAPI("setStorage",{paramsSchema:t.object({key:t.string(),data:t.unknown(),fail:t.function().optional(),complete:t.function().optional()}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;try{var _a=surroundByTryCatchFactory(_anyTypeToString,cardProxyObj._appInstance)(params.data),data=_a.data,dataType=_a.dataType;BDLynxModule.invoke("setStorage",Object.assign(params,{data:data,dataType:dataType}),cb)}catch(ex){typeof params.fail==="function"&&params.fail({errMsg:"setStorage:fail "+ex.message});typeof params.complete==="function"&&params.complete({errMsg:"setStorage:fail "+ex.message})}}});var setStorageSync=createSyncAPI("setStorageSync",{paramsSchema:t.tuple(t.string(),t.unknown()),implement:function(cardProxyObj,key,data){var tmp=surroundByTryCatchFactory(_anyTypeToString,cardProxyObj._appInstance)(data);var dataString=tmp.data;var dataType=tmp.dataType;var callFailed=false;var errMsg="";var result;nativeInvoke(cardProxyObj._appInstance,"setStorageSync",{key:key,data:dataString,dataType:dataType,fail:function(res){errMsg=res.errMsg;callFailed=true}},(function(res){result=res}));if(callFailed){throw new AppServiceSdkKnownError(errMsg)}return result}});var removeStorage=createAPI("removeStorage",{paramsSchema:t.object({key:t.string()}),implement:function(cardProxyObj,cb,params){cardProxyObj.NativeModules.BDLynxModule.invoke("removeStorage",params,cb)}});var removeStorageSync=createSyncAPI("removeStorageSync",{paramsSchema:t.tuple(t.string()),implement:function(cardProxyObj,key){var result;nativeInvoke(cardProxyObj._appInstance,"removeStorageSync",{key:key},(function(res){result=res}));return result}});var clearStorage=createAPI("clearStorage",{implement:function(cardProxyObj,cb,params){cardProxyObj.NativeModules.BDLynxModule.invoke("clearStorage",params,cb)}});var clearStorageSync=createSyncAPI("clearStorageSync",{implement:function(cardProxyObj){var result;nativeInvoke(cardProxyObj._appInstance,"clearStorageSync",{},(function(res){result=res}));return result}});var getStorageInfo=createAPI("getStorageInfo",{implement:function(cardProxyObj,cb,params){cardProxyObj.NativeModules.BDLynxModule.invoke("getStorageInfo",params,cb)}});var getStorageInfoSync=createSyncAPI("getStorageInfoSync",{implement:function(cardProxyObj){var result;nativeInvoke(cardProxyObj._appInstance,"getStorageInfoSync",{},(function(res){result=res;delete res.errMsg}));return result}});var getSystemInfo=createAPI("getSystemInfo",{implement:function(cardProxyObj,cb,params){nativeInvoke(cardProxyObj._appInstance,"getSystemInfo",params,cb,{beforeSuccess:function(res){res.SDKVersion="1.4.0";res.SDKUpdateVersion="1.4.0.1";res.platform=res.platform&&res.platform.toLocaleLowerCase()}})}});var getSystemInfoSync=createSyncAPI("getSystemInfoSync",{implement:function(cardProxyObj){var ret={};nativeInvoke(cardProxyObj._appInstance,"getSystemInfoSync",{},(function(res){res.SDKVersion="1.4.0";res.SDKUpdateVersion="1.4.0.1";res.platform=res.platform&&res.platform.toLocaleLowerCase();res.devicePixelRatio=res.pixelRatio;ret=res}));return ret}});var syncApis=Object.freeze({__proto__:null,createSelectorQuery:createSelectorQuery,getAppInfoSync:getAppInfoSync,getHostInfoSync:getHostInfoSync,getLaunchOptionsSync:getLaunchOptionsSync,onNetworkStatusChange:onNetworkStatusChange,reportAnalytics:reportAnalytics,sendLogV3:sendLogV3,getStorageSync:getStorageSync,getStorageInfoSync:getStorageInfoSync,setStorageSync:setStorageSync,removeStorageSync:removeStorageSync,clearStorageSync:clearStorageSync,getSystemInfoSync:getSystemInfoSync});var VALID_ICON_TYPE=["success","fail","none","loading"];var isValidIconType=function(x){return VALID_ICON_TYPE.includes(x)};var showToast=createAPI("showToast",{paramsSchema:t.object({title:t.string().default(""),icon:t.unknown().default("success"),duration:t.number().default(1500)}),implement:function(cardProxyObj,cb,params){var icon="success";if(isValidIconType(params.icon)){icon=params.icon}cardProxyObj.NativeModules.BDLynxModule.invoke("showToast",__assign(__assign({},params),{icon:icon}),cb)}});var hideToast=createAPI("hideToast",{implement:function(cardProxyObj,cb,params){cardProxyObj.NativeModules.BDLynxModule.invoke("hideToast",params,cb)}});var showModal=createAPI("showModal",{paramsSchema:t.object({title:t.string().default(""),content:t.string().default(""),confirmText:t.string().default("ok"),showCancel:t.unknown().default(true),cancelText:t.string().default("cancel"),confirmColor:t.string().default("#3CC51F"),cancelColor:t.string().default("#000000")}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;var getByteLength=function(str){return str.replace(/[^\u0000-\u00ff]/g,"aa").length};if(getByteLength(params.confirmText)>8){beforeInvokeFail("showModal",params,"confirmText length should not larger than 4 Chinese characters",cardProxyObj._appInstance)}else if(getByteLength(params.cancelText)>8){beforeInvokeFail("showModal",params,"cancelText length should not larger than 4 Chinese characters",cardProxyObj._appInstance)}else{BDLynxModule.invoke("showModal",params,cb)}}});var showLoading=createAPI("showLoading",{paramsSchema:t.object({title:t.string()}),implement:function(cardProxyObj,cb,params){var ONE_DAY_MS=24*60*60*1e3;nativeInvoke(cardProxyObj._appInstance,"showToast",__assign(__assign({},params),{icon:"loading",duration:ONE_DAY_MS}),cb,{beforeAll:function(res){res.errMsg=res.errMsg.replace("showToast","showLoading")}})}});var hideLoading=createAPI("hideLoading",{implement:function(cardProxyObj,cb,params){nativeInvoke(cardProxyObj._appInstance,"hideToast",params,cb,{beforeAll:function(res){res.errMsg=res.errMsg.replace("hideToast","hideLoading")}})}});var showActionSheet=createAPI("showActionSheet",{paramsSchema:t.object({itemList:t.array(t.any()).minItems(1).maxItems(6)}),implement:function(cardProxyObj,cb,params){cardProxyObj.NativeModules.BDLynxModule.invoke("showActionSheet",params,cb)}});var subscribeAppAd=createAPI("subscribeAppAd",{implement:function(cardProxyObj,cb,params){return AdDownloadFile(cardProxyObj,params,cb)}});var downloadAppAd=createAPI("downloadAppAd",{implement:function(cardProxyObj,cb,params){var apiName="downloadAppAd";if(isAndroid()){apiName="dxppAd"}nativeInvoke(cardProxyObj._appInstance,apiName,params,cb,{beforeAll:function(res){res.errMsg=res.errMsg.replace(apiName,"downloadAppAd")}})}});var unsubscribeAppAd=createAPI("unsubscribeAppAd",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("unsubscribeAppAd",params,cb)}});var cancelDownloadAppAd=createAPI("cancelDownloadAppAd",{implement:function(cardProxyObj,cb,params){var apiName="cancelDownloadAppAd";if(isAndroid()){apiName="cancelDxppAd"}nativeInvoke(cardProxyObj._appInstance,apiName,params,cb,{beforeAll:function(res){res.errMsg=res.errMsg.replace(apiName,"cancelDownloadAppAd")}})}});var getAdSiteBaseInfo=createAPI("getAdSiteBaseInfo",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("getAdSiteBaseInfo",params,cb)}});var openAdLandPageLinks=createAPI("openAdLandPageLinks",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("openAdLandPageLinks",params,cb)}});var callHostMethod=createAPI("callHostMethod",{paramsSchema:t.object({method:t.string()}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("callHostMethod",params,cb)}});var scanCode=createAPI("scanCode",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("scanCode",params,cb)}});var getClipboardData=createAPI("getClipboardData",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("getClipboardData",params,cb)}});var setClipboardData=createAPI("setClipboardData",{paramsSchema:t.object({data:t.string()}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("setClipboardData",params,cb)}});var connectSocket=createAPI("connectSocket",{paramsSchema:t.object({url:t.string(),header:t.record(t.unknown()).optional(),protocols:t.array(t.string()).optional()}),implement:function(cardProxyObj,cb,params){if(!validateUrl(params.url,"websocket")){return void beforeInvokeFail("connectSocket",params,'invalid url "'+params.url+'"',cardProxyObj._appInstance)}if(isEmptyArray(params.protocols)){delete params.protocols}typeof params.header!=="object"&&params.header!==undefined&&delete params.header;var header={};params.header&&(header=convertObjectValueToString(params.header));try{var socketTask=new SocketTask(Object.assign({},params,{header:header,header2:Object.keys(header).map((function(k){return[k,String(header[k])]})),cardProxyObj:cardProxyObj,cb:cb}));return socketTask}catch(ex){beforeInvokeFail("connectSocket",params,ex.message,cardProxyObj._appInstance)}}});var getLocation=createAPI("getLocation",{paramsSchema:t.object({type:t.unknown().optional()}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("getLocation",params,cb)}});var openLocation=createAPI("openLocation",{paramsSchema:t.object({latitude:t.number(),longitude:t.number(),scale:t.unknown().default(18),name:t.string().optional(),address:t.string().optional()}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("openLocation",params,cb)}});var chooseLocation=createAPI("chooseLocation",{paramsSchema:t.any(),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("chooseLocation",params,cb)}});var chooseAddress=createAPI("chooseAddress",{paramsSchema:t.any(),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("chooseAddress",params,cb)}});var login=createAPI("login",{paramsSchema:t.object({force:t.unknown().default(true)}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("login",params,cb)}});var navigateToMiniProgram=createAPI("navigateToMiniProgram",{paramsSchema:t.object({appId:t.string().minLength(1),path:t.string().optional(),extraData:t.object().optional(),envVersion:t.enum("current","latest").optional(),callFrom:t.any().optional().default(""),location:t.any().optional().default("")}),implement:function(cardProxyObj,cb,params){var paramErr;var query={};if(params.path&&params.path.indexOf("?")!==-1){try{query=params.path.split("?")[1].split("&").reduce((function(prev,current){var kv=current.split("=");if(kv[0]!==""){prev[kv[0]]=kv[1]||""}return prev}),query)}catch(e){paramErr="path is illegal"}}if(paramErr){throw new UserValidateError(paramErr)}var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("navigateToMiniProgram",{appId:params.appId,startPage:encodeUrlQuery(params.path),query:query,extraData:JSON.stringify(params.extraData),versionType:params.envVersion,callFrom:params.callFrom||"",location:params.location||""},cb)}});var navigateTo=createAPI("navigateTo",{paramsSchema:t.object({url:t.string()}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("navigateTo",params,cb)}});var navigateBack=createAPI("navigateBack",{paramsSchema:t.object({delta:t.unknown().optional()}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;var _a=params.delta,delta=_a===void 0?1:_a;BDLynxModule.invoke("navigateBack",{delta:delta},cb)}});var openSchema=createAPI("openSchema",{paramsSchema:t.object({schema:t.string()}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("openSchema",params,cb)}});var request=requestFactory(false);var verifyRequest=requestFactory(true);var innerRequest=function(cardProxyObj,params,requestCb){return createAPI("innerRequest",{paramsSchema:t.object({url:t.string(),usePrefetchCache:t.boolean().optional(),header:t.object().default({"content-type":"application/json"}),method:t.string().default("GET"),data:t.any().optional(),dataType:t.string().default("json"),responseType:t.string().default("text")}),implement:function(cardProxyObj,cb,params){var data=params.data;if(!validateUrl(params.url)){beforeInvokeFail("innerRequest",params,"invalid url: "+params.url,cardProxyObj._appInstance);return}params.header=Object.keys(params.header).reduce((function(obj,key){key.toLowerCase()==="content-type"?obj[key.toLowerCase()]=params.header[key]:obj[key]=params.header[key];return obj}),{});params.method=params===null||params===void 0?void 0:params.method.toUpperCase();params.responseType=params===null||params===void 0?void 0:params.responseType.toLowerCase();if(params.data===null||typeof params.data==="string"||params.data instanceof ArrayBuffer){data=params.data}else if(typeof params.header["content-type"]==="string"){if(params.header["content-type"].indexOf("application/x-www-form-urlencoded")>-1){data=urlEncodeFormData(params.data,true)}else if(params.header["content-type"].indexOf("application/json")>-1){data=JSON.stringify(params.data)}}else if(typeof params.data==="object"){data=JSON.stringify(params.data)}else{data=params.data.toString()}if(params.method==="GET"){params.url=addQueryStringToUrl(params.url,params.data)}try{var param=Object.assign({},params,{data:data,cardProxyObj:cardProxyObj,cb:requestCb,is_inner:true});return new Request(param)}catch(error){beforeInvokeFail("innerRequest",error,error===null||error===void 0?void 0:error.message,cardProxyObj._appInstance)}}})(cardProxyObj,params)};function requestFactory(is_verify){var requestMethod=is_verify?"verifyRequest":"request";return createAPI(requestMethod,{paramsSchema:t.object({url:t.string(),usePrefetchCache:t.boolean().optional(),header:t.object().default({"content-type":"application/json"}),method:t.string().default("GET"),data:t.any().optional(),dataType:t.string().default("json"),responseType:t.string().default("text")}),implement:function(cardProxyObj,cb,params){var data=params.data;if(!validateUrl(params.url)){beforeInvokeFail(requestMethod,params,"invalid url: "+params.url,cardProxyObj._appInstance);return}params.header=Object.keys(params.header).reduce((function(obj,key){key.toLowerCase()==="content-type"?obj[key.toLowerCase()]=params.header[key]:obj[key]=params.header[key];return obj}),{});params.method=params===null||params===void 0?void 0:params.method.toUpperCase();params.responseType=params===null||params===void 0?void 0:params.responseType.toLowerCase();if(params.data===null||typeof params.data==="string"||params.data instanceof ArrayBuffer){data=params.data}else if(typeof params.header["content-type"]==="string"){if(params.header["content-type"].indexOf("application/x-www-form-urlencoded")>-1){data=urlEncodeFormData(params.data,true)}else if(params.header["content-type"].indexOf("application/json")>-1){data=JSON.stringify(params.data)}}else if(typeof params.data==="object"){data=JSON.stringify(params.data)}else{data=params.data.toString()}if(params.method==="GET"){params.url=addQueryStringToUrl(params.url,params.data)}try{var param=Object.assign({},params,{data:data,cardProxyObj:cardProxyObj,cb:cb,is_verify:is_verify});return new Request(param)}catch(error){beforeInvokeFail(requestMethod,error,error===null||error===void 0?void 0:error.message,cardProxyObj._appInstance)}}})}var requestWXH5Payment=createAPI("requestWXH5Payment",{paramsSchema:t.object({url:t.string(),referer:t.string().optional(),x:t.number().optional(),y:t.number().optional(),width:t.number().optional(),height:t.number().optional()}),implement:function(cardProxyObj,cb,params){var startTime=Date.now();var param=cloneDeep(params);for(var key in param){if(typeof param[key]==="function"){delete param[key]}}reportPaymentAPI("requestWXH5Payment",{state:"before",params:__assign({},param)},cardProxyObj);nativeInvoke(cardProxyObj._appInstance,"requestWXH5Payment",__assign(__assign({},params),{referer:"https://tp-pay.snssdk.com"}),cb,{beforeAll:function(res){var errMsg=res.errMsg;var status=getStatus("requestWXH5Payment",errMsg);reportPaymentAPI("requestWXH5Payment",{state:status,params:__assign({},param),response:res,startTime:startTime,endTime:Date.now()},cardProxyObj)}})}});var requestPayment=createAPI("requestPayment",{paramsSchema:t.object({data:t.object({app_id:t.string(),method:t.string().optional(),sign:t.string().optional(),sign_type:t.string(),timestamp:t.any(),trade_no:t.string(),merchant_id:t.string(),uid:t.string(),pay_channel:t.string().optional(),pay_type:t.string().optional(),risk_info:t.string().optional(),params:t.string(),total_amount:t.number().default(0)}),success:t.function().optional(),fail:t.function().optional(),complete:t.function().optional()}),implement:function(cardProxyObj,cb,params){var startTime=Date.now();var data=params.data,success=params.success,fail=params.fail,complete=params.complete;var confirmPayUrl="https://tp-pay.snssdk.com/gateway";var requestCb=function(res){if(typeof res==="string"){try{res=JSON.parse(res)}catch(e){reportError(new InternalRuntimeError("afterApiCall "+requestPayment+" JSON.parse error: "+e.message,e.stack),cardProxyObj._nativeApp)}}var errMsg=res.errMsg||"innerRequest:ok";var status=getStatus("innerRequest",errMsg);if(status==="success"){var data_1=res.data;if(data_1.response&&Number(data_1.response.code)===1e4){var newData=Object.assign({data:data_1.response.old_pay_param},{success:success,fail:fail,complete:complete});var param_1=cloneDeep(params);for(var key in param_1){if(typeof param_1[key]==="function"){delete param_1[key]}}reportPaymentAPI("requestPayment",{state:"before",params:__assign({},param_1)},cardProxyObj);nativeInvoke(cardProxyObj._appInstance,"requestPayment",newData,cb,{beforeAll:function(res){var errMsg=res.errMsg;var status=getStatus("requestPayment",errMsg);reportPaymentAPI("requestPayment",{state:status,params:__assign({},param_1),response:res,startTime:startTime,endTime:Date.now()},cardProxyObj)}})}else{typeof fail==="function"&&wrapUserFunction("at api requestPayment confirm-pay-success phase fail callback function",cardProxyObj._appInstance,fail)({errMsg:"Order confirmation failed",data:data_1})}typeof complete==="function"&&wrapUserFunction("at api requestPayment confirm-pay-success phase complete callback function",cardProxyObj._appInstance,complete)({errMsg:"requestPayment:complete",data:data_1})}else if(status==="fail"){typeof fail==="function"&&wrapUserFunction("at api requestPayment confirm-pay phase fail callback function",cardProxyObj._appInstance,fail)({errMsg:"Order confirmation failed"})}typeof complete==="function"&&wrapUserFunction("at api requestPayment confirm-pay phase complete callback function",cardProxyObj._appInstance,complete)({errMsg:"requestPayment:complete",data:res})};innerRequest(cardProxyObj,{url:confirmPayUrl,method:"POST",header:{"Content-Type":"application/x-www-form-urlencoded"},responseType:"text",dataType:"json",data:data},requestCb)}});var makePhoneCall=createAPI("makePhoneCall",{paramsSchema:t.object({phoneNumber:t.string()}),implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("makePhoneCall",params,cb)}});var getLocalPhoneNumber=createAPI("getLocalPhoneNumber",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("getLocalPhoneNumber",params,cb)}});var getLocalPhoneNumberToken=createAPI("getLocalPhoneNumberToken",{implement:function(cardProxyObj,cb,params){var BDLynxModule=cardProxyObj.NativeModules.BDLynxModule;BDLynxModule.invoke("getLocalPhoneNumberToken",params,cb)}});var getPhoneNumber=createAPI("getPhoneNumber",{paramsSchema:t.object({disableBindPhoneNumber:t.boolean().optional()}),implement:function(cardProxyObj,cb,params){nativeInvoke(cardProxyObj._appInstance,"_webviewGetPhoneNumber",params,cb,{beforeAll:function(res){res.errMsg=res.errMsg.replace("_webviewGetPhoneNumber","getPhoneNumber")}})}});var sendAdLog=createAPI("sendAdLog",{implement:function(cardProxyObj,cb,params){nativeInvoke(cardProxyObj._appInstance,"sendAdLog",params,cb)}});var asyncApis=Object.freeze({__proto__:null,showActionSheet:showActionSheet,showToast:showToast,showLoading:showLoading,showModal:showModal,hideLoading:hideLoading,hideToast:hideToast,subscribeAppAd:subscribeAppAd,downloadAppAd:downloadAppAd,unsubscribeAppAd:unsubscribeAppAd,cancelDownloadAppAd:cancelDownloadAppAd,getAdSiteBaseInfo:getAdSiteBaseInfo,openAdLandPageLinks:openAdLandPageLinks,callHostMethod:callHostMethod,scanCode:scanCode,getClipboardData:getClipboardData,setClipboardData:setClipboardData,connectSocket:connectSocket,downloadFile:downloadFile,getGeneralInfo:getGeneralInfo,getLocation:getLocation,openLocation:openLocation,chooseLocation:chooseLocation,chooseAddress:chooseAddress,login:login,navigateTo:navigateTo,navigateBack:navigateBack,navigateToMiniProgram:navigateToMiniProgram,getConnectedWifi:getConnectedWifi,getNetworkType:getNetworkType,openSchema:openSchema,request:request,verifyRequest:verifyRequest,requestPayment:requestPayment,requestWXH5Payment:requestWXH5Payment,makePhoneCall:makePhoneCall,getLocalPhoneNumber:getLocalPhoneNumber,getLocalPhoneNumberToken:getLocalPhoneNumberToken,getPhoneNumber:getPhoneNumber,sendAdLog:sendAdLog,getStorage:getStorage,setStorage:setStorage,removeStorage:removeStorage,clearStorage:clearStorage,getStorageInfo:getStorageInfo,getSystemInfo:getSystemInfo});var apiConfig={request:{"1.3.0":[{object:["url","data","header",{method:["GET","POST","PUT"]},"dataType","responseType"]},{success:["data","statusCode","header"]}]},uploadFile:{"1.3.0":[{object:["url","filePath","name","header","formData"]},{success:["data","statusCode"]}]},UploadTask:{"1.3.0":["abort",{onProgressUpdate:[{callback:["progress","totalBytesSent","totalBytesExpectedToSend"]}]}]},downloadFile:{"1.3.0":[{object:["url","header"]},{success:["tempFilePath","statusCode"]}]},DownloadTask:{"1.3.0":["abort",{onProgressUpdate:[{callback:["progress","totalBytesWritten","totalBytesExpectedToWrite"]}]}]},connectSocket:{"1.3.0":[{object:["url","header","protocols"]}]},SocketTask:{"1.3.0":[{send:[{object:["data"]}]},{close:[{object:["code","reason"]}]},"onOpen","onClose","onError","onMessage"]},getStorage:{"1.3.0":[{object:["key"]},{success:["data"]}]},getStorageSync:{"1.3.0":[]},setStorage:{"1.3.0":[{object:["key","data"]}]},setStorageSync:{"1.3.0":[]},removeStorage:{"1.3.0":[{object:["key"]}]},removeStorageSync:{"1.3.0":[]},clearStorage:{"1.3.0":[]},clearStorageSync:{"1.3.0":[]},getStorageInfo:{"1.3.0":[{success:["keys","currentSize","limitSize"]}]},getStorageInfoSync:{"1.3.0":[]},getLocation:{"1.3.0":[{object:["type"]},{success:["latitude","longitude","altitude","accuracy","verticalAccuracy","horizontalAccuracy","speed","city"]}]},openLocation:{"1.3.0":[{object:["latitude","longitude","scale","name","address"]}]},getSystemInfo:{"1.3.0":[{success:["appName","model","pixelRatio","windowWidth","windowHeight","version","system","platform","brand","screenWidth","screenHeight","SDKVersion"]}]},getSystemInfoSync:{"1.3.0":[]},getNetworkType:{"1.3.0":[{success:["networkType"]}]},getConnectedWifi:{"1.3.0":[{success:["SSID","BSSID","secure","signalStrength"]}]},onNetworkStatusChange:{"1.3.0":[{callback:[{networkType:["wifi","2g","3g","4g","none","unknown"]}]}]},scanCode:{"1.3.0":[{success:["result"]}]},showModal:{"1.3.0":[{object:["title","content","showCancel","cancelText","confirmText"]},{success:["confirm","cancel"]}]},showToast:{"1.3.0":[{object:["title","icon","duration"]}]},hideToast:{"1.3.0":[]},showLoading:{"1.3.0":[{object:["title"]}]},hideLoading:{"1.3.0":[]},showActionSheet:{"1.3.0":[{object:["itemList"]},{success:["tapIndex"]}]},makePhoneCall:{"1.3.0":[{object:["phoneNumber"]}]},canIUse:{"1.3.0":[]},createSelectorQuery:{"1.3.0":[]},SelectorQuery:{"1.3.0":["in","select","selectAll","selectViewport","exec"]},login:{"1.3.0":[{object:["force"]},{success:["code","anonymousCode","isLogin"]}]},chooseAddress:{"1.3.0":[{success:["errMsg","userName","provinceName","cityName","countyName","detailInfo","telNumber"]}]},getAdSiteBaseInfo:{"1.3.0":[{success:["errMsg","adInfo","appInfo","userInfo"]}]},getLocalPhoneNumber:{"1.3.0":[]},getLocalPhoneNumberToken:{"1.3.0":[]},getPhoneNumber:{"1.3.0":[{object:["disableBindPhoneNumber"]}]},onFirstLoadPerfReady:{"1.3.0":[{success:["tasm_binary_decode","tasm_end_decode_finish_load_template","tasm_finish_load_template","diff_root_create","js_finish_load_core","js_finish_load_app","tti","js_and_tasm_all_ready","js_runtime_type","corejs_size","layout","first_page_layout","render_page","diff_same_root"]}]},sendLogV3:{"1.3.0":[{object:["eventName","data"]}]},openSchema:{"1.3.0":[{object:["schema"]}]},subscribeAppAd:{"1.3.0":[{object:isAndroid()?["download_url","open_url","cid","log_extra","web_url","web_title","package_name","app_name","source_avatar","auto_open","download_mode","quick_app_url"]:["download_url","open_url","cid","log_extra"]}]},downloadAppAd:{"1.3.0":[{object:isAndroid()?["download_url","open_url","cid","log_extra","web_url","web_title","package_name","app_name","source_avatar","auto_open","download_mode","quick_app_url"]:["download_url","open_url","cid","log_extra"]}]},unsubscribeAppAd:{"1.3.0":[{object:isAndroid()?["download_url","open_url","cid","log_extra","web_url","web_title","package_name","app_name","source_avatar","auto_open","download_mode","quick_app_url"]:["download_url","open_url","cid","log_extra"]}]},cancelDownloadAppAd:{"1.3.0":[{object:isAndroid()?["download_url","open_url","cid","log_extra","web_url","web_title","package_name","app_name","source_avatar","auto_open","download_mode","quick_app_url"]:["download_url","open_url","cid","log_extra"]}]},openAdLandPageLinks:{"1.3.0":[{object:["schema","type","data"]}]},getAppInfoSync:{"1.3.0":[]}};var coreConfig={Card:{"1.3.0":["onLoad","onShow","onHide","onReady","onDestroy","onError","setData","getNodeRef","updateTheme","registerModule","getJSModule","addGlobalEventListener","setSharedData","getSharedData",{GlobalEventEmitter:["addListener","removeListener","emit","removeAllListerners","removeAllListeners","trigger","toggle"]}]},Component:{"1.3.0":[{GlobalEventEmitter:["addListener","removeListener","emit","removeAllListerners","removeAllListeners","trigger","toggle"]},"setData","getNodeRef","triggerEvent"]},NodeRef:{"1.3.0":["getNodeRef","invoke","scrollIntoView"]},require:{"1.3.0":[]},setTimeout:{"1.3.0":[]},setInterval:{"1.3.0":[]},clearTimeout:{"1.3.0":[]},clearInterval:{"1.3.0":[]},define:{"1.3.0":[]},console:{"1.3.0":["log","error","debug","info","warn"]}};function canIUse(schema){return Boolean(checkApi(schema))||Boolean(checkCore(schema))}function checkApi(schema){var _a=__read(schema.split("."),4),api=_a[0],method=_a[1],param=_a[2],options=_a[3];var supportedVersions=getSupportVersions(api,apiConfig,"1.4.0");if(supportedVersions.length===0){return false}var methods;if(method){methods=getKeysProps(supportedVersions,apiConfig[api],method);if(!methods){return false}}var paramss;return(!param||void 0!==(paramss=findin(methods,param)))&&(!options||void 0!==findin(paramss,options))}function checkCore(schema){var _a=__read(schema.split("."),4),schema1=_a[0],schema2=_a[1],schema3=_a[2],schema4=_a[3];var supportedVersions=getSupportVersions(schema1,coreConfig,(SystemInfo===null||SystemInfo===void 0?void 0:SystemInfo.lynxVersion)||"88.88.88");if(supportedVersions.length===0){return false}var methods;if(schema2){methods=getKeysProps(supportedVersions,coreConfig[schema1],schema2);if(!methods){return false}}var paramss;return(!schema3||void 0!==(paramss=findin(methods,schema3)))&&(!schema4||void 0!==findin(paramss,schema4))}function getSupportVersions(query,config,version){if(!query){return[]}var configKeys=Object.keys(config);var idx=configKeys.indexOf(query);if(idx===-1){return[]}var item=config[configKeys[idx]];return Object.keys(item).filter((function(t){return compareVersion(t,version)<=0}))}function getKeysProps(versions,configs,key){var res;for(var ver=0;ver<versions.length;ver++){for(var aversion=configs[versions[ver]],c=0;c<aversion.length;c++){var item=aversion[c];if(typeof item==="string"&&item===key){void 0===res&&(res=[]);break}if(typeof item==="object"&&item.hasOwnProperty(key)){res=void 0===res?item[key]:res.concat(item[key]);break}}}return res}function findin(array,target){for(var i=0;i<array.length;i++){if(typeof array[i]==="string"&&array[i]===target){return[]}if(typeof array[i]==="object"&&array[i].hasOwnProperty(target)){return array[i][target]}}}function apiInit(){var e_1,_a,e_2,_b;var apiList={};var cardProxyObj=this;var _loop_1=function(key,value){apiList[key]=function(){var inputs=[];for(var _i=0;_i<arguments.length;_i++){inputs[_i]=arguments[_i]}return value.apply(void 0,__spread([cardProxyObj],inputs))}};try{for(var _c=__values(Object.entries(syncApis)),_d=_c.next();!_d.done;_d=_c.next()){var _e=__read(_d.value,2),key=_e[0],value=_e[1];_loop_1(key,value)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{if(_d&&!_d.done&&(_a=_c.return))_a.call(_c)}finally{if(e_1)throw e_1.error}}var _loop_2=function(key,value){apiList[key]=function(input){return value(cardProxyObj,input)}};try{for(var _f=__values(Object.entries(asyncApis)),_g=_f.next();!_g.done;_g=_f.next()){var _h=__read(_g.value,2),key=_h[0],value=_h[1];_loop_2(key,value)}}catch(e_2_1){e_2={error:e_2_1}}finally{try{if(_g&&!_g.done&&(_b=_f.return))_b.call(_f)}finally{if(e_2)throw e_2.error}}apiList["canIUse"]=canIUse;return apiList}_global.BDLynxSDKCore={apiInit:apiInit,registerNativeEvent:registerNativeEvent};exports.apiInit=apiInit;return exports})({});
//# sourceMappingURL=bdlynx_core.js.map
