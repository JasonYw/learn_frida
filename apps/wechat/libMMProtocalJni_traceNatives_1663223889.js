


function print_arg(addr){
    var module = Process.findRangeByAddress(addr)
    if(module != null) return hexdump(addr) + "\n"
    return ptr(addr) + "\n"
}


function hook_so_func(addr,paramsnum,relativePtr){
    Interceptor.attach(addr,{
        onEnter:function(args){
            this.logs = []
            this.params =[]
            for(var i=0;i<paramsnum;i++){
                this.params.push(args[i])
                this.logs.push("args"+i+"-onEnter:"+print_arg(args[i]))
            }
        },
        onLeave:function(retval){
            for(var i=0;i<paramsnum;i++){
                this.logs.push("args"+i+"-onLeave:"+print_arg(this.params[i]))
            }
            this.logs.push("retval onLeave=>"+print_arg(retval)+"\n")
            console.log("funcaddr:",addr.toString(16),"relativePtr:",relativePtr.toString(16),"====>")
            console.log(this.logs)
            console.log('====================================================================\n')
        }
    })
}



function hook_suspected_function(targetSo) {
    const funcs = [0x312c0,0x35c10,0x36484,0x3655c,0x36e54,0x374b8,0x37918,0x37f6c,0x38124,0x38190,0x385ec,0x38f20,0x38fe0,0x39010,0x39084,0x39108,0x39158,0x391b8,0x3930c,0x393c8,0x39420,0x39460,0x394d0,0x3958c,0x39780,0x397e4,0x3990c,0x39a64,0x39b54,0x39d64,0x39ea0,0x39fc8,0x3a138,0x3a288,0x3a3d4,0x3a434,0x3a628,0x3a698,0x3a82c,0x3a870,0x3a95c,0x3aa50,0x3ab34,0x3ab9c,0x3b07c,0x3b0c8,0x3b270,0x3b778,0x3bc58,0x3bd34,0x3c27c,0x3c3c0,0x3c4cc,0x3c4fc,0x3c5a0,0x3c638,0x3c668,0x3c738,0x3c874,0x3c8d4,0x3ca38,0x3ccd0,0x3d418,0x3d434,0x3d450,0x3d5f4,0x3d724,0x3d8a0,0x3d9ec,0x3ddac,0x3df40,0x3e24c,0x3e28c,0x3e324,0x3e3bc,0x3e470,0x3e54c,0x3e5f0,0x3e620,0x3e75c,0x3eb20,0x3ecd8,0x3ed4c,0x3edec,0x3ee0c,0x3ee84,0x3ef48,0x3ef78,0x3eff4,0x3f074,0x3f0fc,0x3f298,0x3f434,0x3f4b0,0x3f6d8,0x3f868,0x3facc,0x3fbb0,0x3fdbc,0x40070,0x40418,0x40474,0x40504,0x405f8,0x40690,0x40700,0x40770,0x40860,0x40954,0x409ac,0x40b40,0x40e7c,0x41094,0x411c0,0x41234,0x413ec,0x415b4,0x41794,0x41970,0x41b58,0x41d50,0x41e1c,0x41f14,0x4201c,0x42120,0x4222c,0x42514,0x425b4,0x42664,0x428f0,0x429a4,0x429d4,0x42a30,0x42a98,0x42b98,0x42bdc,0x42c20,0x42c64,0x42ca8,0x42cec,0x42d48,0x42d60,0x42e24,0x42f3c,0x43038,0x43148,0x431f0,0x43278,0x432d8,0x43334,0x433dc,0x43528,0x43784,0x43878,0x43990,0x43a74,0x43b70,0x43c88,0x43da0,0x43eb4,0x43fc8,0x440f4,0x44230,0x442c4,0x44400,0x44494,0x445d0,0x44660,0x446f0,0x4482c,0x449bc,0x44a00,0x44a64,0x44c30,0x44c60,0x44cb8,0x44d00,0x44e34,0x44f24,0x44fd8,0x4503c,0x45074,0x45380,0x45420,0x45470,0x454b4,0x455b4,0x45638,0x45690,0x456c4,0x458b4,0x45940,0x45a48,0x45b58,0x45c58,0x45ce0,0x45de8,0x45e58,0x45ec8,0x45f70,0x4604c,0x46110,0x461d4,0x46288,0x4633c,0x463a8,0x46414,0x46480,0x464ec,0x46598,0x46644,0x46754,0x4678c,0x467b8,0x467e4,0x468ec,0x469f4,0x46b08,0x46c1c,0x46cfc,0x46ddc,0x46ef8,0x47068,0x471d8,0x473bc,0x4759c,0x47780,0x47960,0x47b44,0x47d24,0x47ea4,0x48024,0x4822c,0x48484,0x484b4,0x48524,0x4855c,0x48594,0x485c8,0x48614,0x48660,0x486dc,0x48758,0x487d4,0x48850,0x488cc,0x48948,0x48994,0x489e0,0x48a64,0x48ae8,0x48b38,0x48b70,0x48bcc,0x48cc0,0x48ec0,0x48fe0,0x492b0,0x4963c,0x49744,0x49ae0,0x49c00,0x49d38,0x4a750,0x4a900,0x4aa50,0x4aaf8,0x4ad48,0x4adb8,0x4adfc,0x4b048,0x4b160,0x4b254,0x4b374,0x4b814,0x4bd90,0x4bf50,0x4c2e0,0x4c3d8,0x4c580,0x4c720,0x4c808,0x4c944,0x4ca18,0x4cac0,0x4cb68,0x4cdbc,0x4d004,0x4d2f4,0x4d3cc,0x4d570,0x4d5fc,0x4ed6c,0x4f234,0x50098,0x50234,0x503bc,0x50894,0x50d2c,0x50ee4,0x518c4,0x51b5c,0x51c3c,0x51d38,0x51dc0,0x51e84,0x51f74,0x5207c,0x521a0,0x521e4,0x52210,0x52234,0x52260,0x5226c,0x522a4,0x522cc,0x52328,0x523ec,0x524c8,0x52608,0x52790,0x52804,0x52904,0x53308,0x5345c,0x5348c,0x5357c,0x538bc,0x53ae4,0x53e88,0x54204,0x546a8,0x5478c,0x547bc,0x5482c,0x54880,0x548d8,0x54ac4,0x54b74,0x54bd0,0x54d88,0x54dfc,0x54fa0,0x5503c,0x55098,0x55140,0x55204,0x55240,0x55300,0x5535c,0x55428,0x55724,0x559b4,0x55bd8,0x55e00,0x55fe0,0x56070,0x56170,0x56220,0x56304,0x563e4,0x564bc,0x56540,0x5665c,0x5674c,0x567fc,0x56924,0x56a4c,0x56b5c,0x572e0,0x574c4,0x57acc,0x57c58,0x57cb0,0x57d9c,0x58560,0x585f8,0x59038,0x592e8,0x59684,0x596bc,0x597a4,0x5987c,0x5999c,0x59a10,0x59aac,0x59b28,0x59c8c,0x59d28,0x59d58,0x59ec8,0x59f14,0x59f7c,0x59ff4,0x5a0bc,0x5a150,0x5a1e4,0x5a278,0x5a30c,0x5a854,0x5a950,0x5aa3c,0x5aac4,0x5ad30,0x5ad98,0x5ae5c,0x5af14,0x5b010,0x5b0fc,0x5b1e4,0x5b24c,0x5b2fc,0x5b3a8,0x5b3d8,0x5b4e8,0x5b61c,0x5b64c,0x5b690,0x5b6f8,0x5b7f4,0x5cf10,0x5cfbc,0x5d5a8,0x5d5fc,0x5d664,0x5d6bc,0x5d714,0x5d74c,0x5d848,0x5da2c,0x5daac,0x5dc28,0x5dc54,0x5dca0,0x5dcd4,0x5e018,0x5e084,0x5e1f0,0x5e284,0x5e2d0,0x5e39c,0x5e468,0x5e534,0x5e5dc,0x5e62c,0x5e714,0x5e7fc,0x5e948,0x5e9a0,0x5ea1c,0x5eda0,0x5ee2c,0x5f000,0x5f17c,0x5f29c,0x5f4bc,0x5f5ac,0x5f730,0x5f860,0x5f894,0x5f8fc,0x5f9a4,0x5fa5c,0x5faac,0x5fb80,0x5fbf4,0x5fc20,0x5fd18,0x5fe20,0x5ff7c,0x60000,0x6012c,0x60318,0x60374,0x603e8,0x60558,0x606c4,0x60920,0x60c00,0x60d64,0x60eb0,0x60f3c,0x61060,0x610f8,0x61180,0x61240,0x612e4,0x6131c,0x6162c,0x616cc,0x617ec,0x61a24,0x61ac8,0x61c7c,0x61c84,0x6202c,0x62500,0x62628,0x627bc,0x627f4,0x62848,0x631cc,0x6338c,0x63830,0x63a60,0x63d44,0x64058,0x642d4,0x64344,0x6437c,0x643c8,0x64450,0x644ec,0x64638,0x646f0,0x64810,0x6497c,0x64a9c,0x64b08,0x64c0c,0x64cc4,0x64d1c,0x64d50,0x64d84,0x64ddc,0x64e38,0x64ea8,0x64f10,0x64ff0,0x65270,0x652b4,0x65370,0x654a4,0x65568,0x655fc,0x65764,0x6580c,0x65994,0x65b48,0x65b7c,0x65ca8,0x65d44,0x65dd0,0x65e5c,0x65f20,0x65f78,0x66030,0x66164,0x662e8,0x6649c,0x6667c,0x667ec,0x66b60,0x66c2c,0x66d00,0x66dd4,0x66ef8,0x66ff8,0x670f8,0x67438,0x674d8,0x675f4,0x677c8,0x678c8,0x679ac,0x67a00,0x68cc8,0x68d18,0x68d88,0x68df8,0x68e90,0x69094,0x6921c,0x69300,0x698ec,0x6994c,0x69aac,0x69b98,0x69c20,0x69e00,0x6a0f4,0x6a57c,0x6a6f0,0x6ab80,0x6ae4c,0x6b0dc,0x6b2bc,0x6b38c,0x6b464,0x6b62c,0x6b818,0x6b92c,0x6b97c,0x6ba7c,0x6bc2c,0x6bcf0,0x6bd4c,0x6bf28,0x6c76c,0x6c7e0,0x6cd8c,0x6d264,0x6d30c,0x6d748,0x6d7c4,0x6d818,0x6d858,0x6da28,0x6daa0,0x6dc20,0x6dd0c,0x6ddc8,0x6de0c,0x6de40,0x6df30,0x6df78,0x6e2a8,0x6e368,0x6e430,0x6e4ac,0x6e508,0x6e628,0x6e6e0,0x6e70c,0x6e778,0x6e800,0x6e83c,0x6e878,0x6e8b4,0x6e8f0,0x6e92c,0x6ebc0,0x6ec34,0x6ec70,0x6ecdc,0x6ed9c,0x6ee04,0x6ee6c,0x6eed4,0x6ef3c,0x6efa4,0x6f00c,0x6f08c,0x6f100,0x6f168,0x6f1d0,0x6f238,0x6f2a0,0x6f320,0x6f398,0x6f45c,0x6f4c4,0x6ffe0,0x70010,0x7008c,0x7011c,0x703c8,0x7097c,0x709b0,0x70db8,0x70e74,0x7104c,0x7109c,0x710d0,0x71234,0x713bc,0x71438,0x714f4,0x71544,0x71570,0x715e8,0x7169c,0x71768,0x71b50,0x71bc0,0x71d34,0x71ebc,0x71fc8,0x7206c,0x722c0,0x72b2c,0x72c0c,0x72d28,0x72db8,0x72f9c,0x73110,0x73170,0x73200,0x7324c,0x732b0,0x73b88,0x73bf0,0x73cf0,0x73dd0,0x740a8,0x747dc,0x74bd4,0x74ef8,0x75228,0x75494,0x75b6c,0x75ea4,0x761e8,0x76654,0x76abc,0x77010,0x77048,0x771bc,0x77250,0x77390,0x77464,0x77600,0x776d4,0x77868,0x778d8,0x77958,0x77cc4,0x77e44,0x782a0,0x78360,0x78484,0x7854c,0x785a0,0x78628,0x7869c,0x78700,0x78788,0x78850,0x78c00,0x792bc,0x79324,0x7939c,0x79474,0x797dc,0x79980,0x79a68,0x79d6c,0x79e10,0x79f00,0x7a020,0x7a114,0x7a298,0x7a304,0x7a3a4,0x7a3e8,0x7a614,0x7a8b0,0x7abd0,0x7ad6c,0x7aed8,0x7b19c,0x7b308,0x7b31c,0x7b384,0x7b3b4,0x7b45c,0x7b4d8,0x7b674,0x7b774,0x7b7dc,0x7ba68,0x7bb70,0x7bc08,0x7bc38,0x7bd00,0x7c0f4,0x7c584,0x7c9ec,0x7ca84,0x7caf8,0x7cbd4,0x7cc58,0x7ccac,0x7cd94,0x7ce84,0x7cfe0,0x7d460,0x7d5e8,0x7d734,0x7d7e0,0x7d93c,0x7dab4,0x7dba0,0x7dc3c,0x7e440,0x7e548,0x7e5e0,0x7e61c,0x7e9e0,0x7ea34,0x7ea6c,0x7eb6c,0x7ec78,0x7ecf8,0x7ed60,0x7ee10,0x7ee3c,0x7eec0,0x7ef7c,0x7f038,0x7f074,0x7f0f8,0x7f128,0x7f15c,0x7f28c,0x7f2ec,0x7f35c,0x7f5dc,0x7f7c0,0x7f8b0,0x7f920,0x7f92c,0x7f988,0x7fd48,0x7fd54,0x80464,0x80720,0x80820,0x808c8,0x80968,0x80a14,0x80b60,0x80c70,0x80c78,0x80cec,0x80e34,0x81064,0x8114c,0x81438,0x81728,0x818c0,0x81b64,0x81d10,0x81e1c,0x81e6c,0x81f84,0x82008,0x8208c,0x82254,0x82418,0x824a4,0x824e0,0x82578,0x82714,0x827a0,0x827fc,0x828a8,0x828d8,0x82958,0x829c8,0x829fc,0x82b54,0x82c64,0x82e78,0x82fd8,0x83114,0x831d4,0x8324c,0x83290,0x833bc,0x8379c,0x83e68,0x840c8,0x84298,0x84300,0x844c0,0x846c4,0x84944,0x84a24,0x84ec8,0x84f78,0x84fe8,0x8501c,0x8504c,0x850b0,0x85110,0x85220,0x8525c,0x852bc,0x85358,0x855bc,0x856b0,0x858d8,0x8591c,0x859ac,0x85a50,0x85ba0,0x85c00,0x85d3c,0x85dd8,0x85e88,0x85eb4,0x85ef4,0x85f34,0x86034,0x86200,0x873c0,0x87664,0x876a8,0x8775c,0x877cc,0x877fc,0x87834,0x87888,0x8792c,0x87968,0x879b4,0x879f4,0x87a60,0x87b00,0x87bf4,0x889a4,0x89108,0x89338,0x893b8,0x8943c,0x8948c,0x89510,0x89558,0x8964c,0x89698,0x896e8,0x897d0,0x89a90,0x8a1c4,0x8a390,0x8a47c,0x8a6ac,0x8a6e4,0x8a724,0x8a7e4,0x8aa68,0x8b0b8,0x8b2c0,0x8b638,0x8b70c,0x8b79c,0x8ba58,0x8bc50,0x8bd9c,0x8c2dc,0x8c378,0x8c4bc,0x8c560,0x8c86c,0x8ca50,0x8ca84,0x8cab8,0x8cb54,0x8ccc0,0x8cd08,0x8cd50,0x8cda0,0x8cde4,0x8ce4c,0x8cfa0,0x8d07c,0x8d144,0x8d200,0x8d248,0x8d318,0x8d35c,0x8d3e4,0x8d494,0x8d568,0x8d5c8,0x8d7e8,0x8dab8,0x8dc50,0x8de8c,0x8e2a8,0x8e2e8,0x8e350,0x8e42c,0x8e470,0x8e534,0x8e77c,0x8e954,0x8eafc,0x8ebe8,0x8ed14,0x8f0e0,0x8f40c,0x8f45c,0x8f4ec,0x8f59c,0x8f61c,0x8f69c,0x8f6fc,0x8f8c8,0x8faf4,0x8fb94,0x8fda0,0x8ff4c,0x8ffd4,0x90108,0x9017c,0x9025c,0x90294,0x9049c,0x90520,0x90694,0x90814,0x90930,0x9099c,0x90a08,0x90a74,0x90e54,0x90ff0,0x91298,0x91398,0x9159c,0x91724,0x9178c,0x9188c,0x91b64,0x91be8,0x91c28,0x91c70,0x91d98,0x91ef0,0x92040,0x92100,0x92330,0x92420,0x92464,0x925d4,0x92630,0x92968,0x92c08,0x93000,0x93464,0x939dc,0x93db0,0x93e28,0x93e80,0x9403c,0x94158,0x94340,0x94394,0x943c0,0x94438,0x945e4,0x9472c,0x947b0,0x94a90,0x95038,0x95444,0x9549c,0x95748,0x959d4,0x95aec,0x95ee0,0x96000,0x963f0,0x96740,0x96f10,0x97978]
    for (var i =0;i<funcs.length;i++) {
        var funcPtr =targetSo.add(funcs[i])
        hook_so_func(funcPtr,6,funcs[i])
    }
}


function main() {
    var targetSo = Module.findBaseAddress("libMMProtocalJni.so")
    hook_suspected_function(targetSo)
}

main()
        